<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>J.A.R.V.I.S.I. Just A Really Versatile, Insightful & Soft Intelligence </title>
    
    <!-- 
    =================================================================
    ğŸ¯ FUI TEMPLATE USAGE GUIDE - FUIæ¨¡æ¿ä½¿ç”¨æŒ‡å—
    =================================================================
    
    ğŸ“– æ¨¡æ¿è¯´æ˜ï¼š
    è¿™æ˜¯ä¸€ä¸ªç”¨äº3DçƒçŠ¶ç•Œé¢çš„LLMå†…å®¹ç”Ÿæˆæ¨¡æ¿ã€‚ä¸»è¦ç”¨äºå¿«é€Ÿæ›¿æ¢å†…å®¹è€Œæ— éœ€é‡æ–°ç”Ÿæˆæ•´ä¸ªç•Œé¢ä»£ç ã€‚
    
    ğŸ”„ ä¸»è¦æ›¿æ¢åŒºåŸŸï¼š
    1. DYNAMIC CONTENT ZONE (åŠ¨æ€å†…å®¹åŒºåŸŸ)
       - ä½ç½®ï¼šJavaScript ä¸­çš„ contentTemplates æ•°ç»„
       - å†…å®¹ï¼šå¡ç‰‡æ ‡é¢˜å’Œå†…å®¹
       - æ ¼å¼ï¼š{ title: 'xxx', content: () => `htmlå†…å®¹` }
    
    âš™ï¸ å¯é€‰é…ç½®ï¼š
    1. å¡ç‰‡æ•°é‡ï¼šè‡ªåŠ¨æ ¹æ®contentTemplatesæ•°ç»„é•¿åº¦ç¡®å®š
    2. å†…å®¹æ›´æ–°é—´éš”ï¼šinitå‡½æ•°ä¸­çš„setIntervalæ—¶é—´
    
    ğŸ¨ å†…å®¹æ ·å¼æŒ‡å—ï¼š
    - æ”¯æŒHTMLæ ‡ç­¾ï¼š<p>, <span>, <br> ç­‰
    - å¯ç”¨CSSç±»ï¼š.text-green-400, .code-string, .font-bold ç­‰
    - æ”¯æŒåŠ¨æ€JSå˜é‡ï¼š${Date.now()}, ${Math.random()} ç­‰
    - æ¨èä½¿ç”¨è¡¨æƒ…ç¬¦å·å’Œç‰¹æ®Šå­—ç¬¦å¢å¼ºè§†è§‰æ•ˆæœ
    
    âŒ ä¸å»ºè®®ä¿®æ”¹çš„åŒºåŸŸï¼š
    - CSSæ ·å¼å®šä¹‰
    - JavaScriptå‡½æ•°é€»è¾‘
    - HTMLç»“æ„æ¡†æ¶
    - ç‰©ç†å’ŒåŠ¨ç”»å‚æ•°
    
    =================================================================
    -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@300;400;500&family=Teko:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        * {
            box-sizing: border-box;
        }
        
        html {
            margin: 0;
            padding: 0;
            background: rgb(0, 0, 0) !important;
        }
        
        :root {
            --fui-primary: #a7d5ff;
            --fui-secondary: #ffa500;
            --fui-bg: #03080f;
            --fui-panel-bg: rgba(15, 35, 60, 0.5);
            --fui-border-color: rgba(135, 206, 250, 0.3);
            
            /* Highlight Colors */
            --highlight-color-pink: #EC4899;
            --highlight-color-blue: #3B82F6;
            --highlight-color-yellow: #FBBF24;
            --highlight-bg-pink: rgba(236, 72, 153, 0.15);
            --highlight-border-pink: rgba(236, 72, 153, 0.6);
            --highlight-bg-blue: rgba(59, 130, 246, 0.15);
            --highlight-border-blue: rgba(59, 130, 246, 0.6);
            --highlight-bg-yellow: rgba(251, 191, 36, 0.15);
            --highlight-border-yellow: rgba(251, 191, 36, 0.6);
        }

        body {
            background-color: rgb(8, 20, 35) !important;
            background-image: radial-gradient(circle at center, rgb(15, 35, 60) 0%, rgb(12, 28, 50) 60%, rgb(8, 20, 35) 85%, rgb(3, 8, 15) 100%) !important;
            color: var(--fui-primary);
            font-family: 'Roboto Mono', monospace;
            overflow: hidden;
            cursor: grab;
            min-height: 100vh;
            margin: 0;
            padding: 0;
            width: 100vw;
            height: 100vh;
        }
        .perspective-container {
            width: 100%;
            height: 100%;
            perspective: 2500px;
            position: absolute;
            transform-style: preserve-3d;
        }
        .scene-origin {
            width: 100%;
            height: 100%;
            position: absolute;
            transform-style: preserve-3d;
            will-change: transform;
        }
        .fui-window {
            position: absolute;
            top: 50%; left: 50%;
            background: var(--fui-panel-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--fui-border-color);
            border-radius: 12px;
            box-shadow: 0 0 25px rgba(0, 150, 255, 0.1);
            transform-style: preserve-3d;
            transition: box-shadow 0.3s ease, border-color 0.3s ease, background 0.4s ease, opacity 0.5s ease;
            will-change: transform, background, border-color, opacity;
            user-select: none;
        }
        .fui-window.focused {
            border-color: rgba(255, 165, 0, 0.7);
            box-shadow: 0 0 35px rgba(255, 165, 0, 0.6);
            z-index: 2000 !important;
        }
        .fui-header {
            background: rgba(135, 206, 250, 0.1);
            padding: 12px 20px;
            cursor: grab;
            border-bottom: 1px solid rgba(135, 206, 250, 0.2);
            font-family: 'Teko', sans-serif;
            font-size: 1.5rem; /* 24px */
            letter-spacing: 0.05em;
        }
        .fui-content {
            padding: 20px;
            font-size: 14px;
            line-height: 1.7;
            overflow-y: auto;
            overflow-x: hidden;
            word-wrap: break-word;
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 165, 0, 0.5) transparent;
        }
        .fui-content::-webkit-scrollbar {
            width: 6px;
        }
        .fui-content::-webkit-scrollbar-track {
            background: transparent;
        }
        .fui-content::-webkit-scrollbar-thumb {
            background: rgba(255, 165, 0, 0.5);
            border-radius: 3px;
        }
        .fui-content::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 165, 0, 0.8);
        }
        .resize-handle {
            position: absolute;
            right: 0; bottom: 0; width: 20px; height: 20px;
            cursor: se-resize; z-index: 10;
            border-bottom: 2px solid rgba(255, 165, 0, 0.5);
            border-right: 2px solid rgba(255, 165, 0, 0.5);
        }
        .controls-panel {
            position: fixed;
            top: 15px; right: 15px; background: rgba(15, 35, 60, 0.7);
            backdrop-filter: blur(10px); border: 1px solid var(--fui-border-color);
            border-radius: 8px; padding: 8px 12px; z-index: 3000;
            font-family: 'Teko', sans-serif; letter-spacing: 0.05em;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
            transform-origin: top right;
        }
        
        .controls-panel.collapsed {
            width: 44px;
            height: 44px;
            padding: 8px;
            border-radius: 50%;
        }
        
        .controls-toggle-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 28px;
            height: 28px;
            background: rgba(255, 165, 0, 0.15);
            border: 1px solid rgba(255, 165, 0, 0.4);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--fui-secondary);
            transition: all 0.3s ease;
            z-index: 1;
        }
        
        .controls-toggle-btn:hover {
            background: rgba(255, 165, 0, 0.25);
            border-color: rgba(255, 165, 0, 0.7);
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(255, 165, 0, 0.3);
        }
        
        .controls-content {
            transition: opacity 0.3s ease, visibility 0.3s ease;
            min-width: 160px;
        }
        
        .controls-panel.collapsed .controls-content {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }
        
        .controls-panel.collapsed .controls-toggle-btn {
            position: relative;
            top: 0;
            right: 0;
            margin: 0;
        }
        .control-label { font-size: 0.9rem; color: var(--fui-primary); }
        .control-value { font-size: 0.9rem; color: var(--fui-secondary); }
        .control-slider {
            -webkit-appearance: none; appearance: none;
            width: 100px; height: 3px; background: rgba(135, 206, 250, 0.3); outline: none;
            border-radius: 2px; transition: background 0.3s; margin-top: 2px;
        }
        .control-slider::-webkit-slider-thumb {
            -webkit-appearance: none; appearance: none;
            width: 14px; height: 14px; background: var(--fui-secondary);
            cursor: pointer; border-radius: 50%; border: 2px solid var(--fui-bg);
        }
        .control-slider::-moz-range-thumb {
            width: 14px; height: 14px; background: var(--fui-secondary);
            cursor: pointer; border-radius: 50%; border: 2px solid var(--fui-bg);
        }
        .code-keyword { color: #c792ea; }
        .code-string { color: #c3e88d; }
        .code-comment { color: #546e7a; }
        .code-variable { color: #82aaff; }

        /* --- Radial Menu --- */
        /* æš‚æ—¶æ³¨é‡Šæ‰å¾„å‘èœå•åŠŸèƒ½ - 2024å¹´æ›´æ–°
        .radial-menu-container {
            position: absolute; width: 240px; height: 240px;
            pointer-events: none; opacity: 0; z-index: 50;
            clip-path: polygon(50% 50%, 50% 0%, 50% 0%);
            transition: opacity 0.4s ease-out, clip-path 0.4s cubic-bezier(0.45, 0, 0.55, 1);
        }
        .radial-menu-container.active {
            opacity: 1; pointer-events: auto;
            clip-path: polygon(50% 50%, 50% 0%, 100% 0%, 100% 100%, 0% 100%, 0% 0%, 50% 0%);
        }
        .radial-menu-arc {
            position: absolute; width: 100%; height: 100%;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(15, 35, 60, 0.1) 40%, rgba(135, 206, 250, 0.3) 68%, rgba(135, 206, 250, 0.5) 70%, transparent 71%);
            box-shadow: 0 0 20px rgba(135, 206, 250, 0.3) inset;
        }
        .radial-menu-item {
            position: absolute; top: 50%; left: 50%;
            margin: -18px; width: 36px; height: 36px;
            background: rgba(15, 35, 60, 0.7);
            border: 1px solid rgba(135, 206, 250, 0.5);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            cursor: pointer; color: var(--fui-primary); opacity: 0;
            transform: translate(var(--tx, 0px), var(--ty, 0px)) scale(0);
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.3s ease-out, background 0.2s, border-color 0.2s;
            transition-delay: var(--delay, 0s);
        }
        .radial-menu-container.active .radial-menu-item {
            transform: translate(var(--tx, 0px), var(--ty, 0px)) scale(1);
            opacity: 1;
        }
        .radial-menu-item:hover {
            background: rgba(255, 165, 0, 0.4);
            border-color: rgba(255, 165, 0, 0.8);
            transform: translate(var(--tx, 0px), var(--ty, 0px)) scale(1.15);
        }
        */

        /* --- Marker Dots --- */
        .marker-dots {
            position: absolute; top: 15px; right: 15px;
            display: flex; gap: 8px; z-index: 20;
        }
        .marker-dot {
            width: 8px; height: 8px;
            border-radius: 50%; cursor: pointer;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .marker-dot:hover {
            transform: scale(1.4);
            box-shadow: 0 0 6px currentColor;
        }
        .dot-pink { background-color: var(--highlight-color-pink); color: var(--highlight-color-pink);}
        .dot-blue { background-color: var(--highlight-color-blue); color: var(--highlight-color-blue);}
        .dot-yellow { background-color: var(--highlight-color-yellow); color: var(--highlight-color-yellow);}
        .fui-window.highlight-pink {
            background: var(--highlight-bg-pink) !important;
            border-color: var(--highlight-border-pink);
        }
        .fui-window.highlight-blue {
            background: var(--highlight-bg-blue) !important;
            border-color: var(--highlight-border-blue);
        }
        .fui-window.highlight-yellow {
            background: var(--highlight-bg-yellow) !important;
            border-color: var(--highlight-border-yellow);
        }

        /* --- Center Card Highlight --- */
        .fui-window.center-highlight {
            box-shadow: 0 0 25px rgba(255, 215, 0, 0.3), 0 0 50px rgba(255, 215, 0, 0.15) !important;
            border-color: rgba(255, 215, 0, 0.5) !important;
            transform-style: preserve-3d;
            animation: centerCardPulse 3s ease-in-out infinite;
        }

        @keyframes centerCardPulse {
            0%, 100% { 
                box-shadow: 0 0 25px rgba(255, 215, 0, 0.3), 0 0 50px rgba(255, 215, 0, 0.15);
            }
            50% { 
                box-shadow: 0 0 30px rgba(255, 215, 0, 0.4), 0 0 60px rgba(255, 215, 0, 0.2);
            }
        }

        /* --- ä¸­å¿ƒå®šä½æ ‡è®° --- */
        .center-crosshair {
            position: fixed;
            top: 50%;
            left: 50%;
            width: 60px;
            height: 60px;
            transform: translate(-50%, -50%);
            z-index: 100;
            pointer-events: none;
        }

        .crosshair-ring {
            position: absolute;
            width: 100%;
            height: 100%;
            border: 2px solid transparent;
            border-radius: 50%;
            animation: crosshairPulse 2s ease-in-out infinite;
        }

        .crosshair-ring:nth-child(1) {
            border-color: rgba(135, 206, 250, 0.8);
            animation-delay: 0s;
        }

        .crosshair-ring:nth-child(2) {
            border-color: rgba(255, 165, 0, 0.6);
            animation-delay: 0.5s;
            width: 80%;
            height: 80%;
            top: 10%;
            left: 10%;
        }

        .crosshair-ring:nth-child(3) {
            border-color: rgba(135, 206, 250, 0.4);
            animation-delay: 1s;
            width: 60%;
            height: 60%;
            top: 20%;
            left: 20%;
        }

        .crosshair-center {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 8px;
            height: 8px;
            background: radial-gradient(circle, rgba(255, 165, 0, 0.9) 0%, rgba(135, 206, 250, 0.6) 100%);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 20px rgba(255, 165, 0, 0.8);
            animation: centerDot 1.5s ease-in-out infinite alternate;
        }

        @keyframes crosshairPulse {
            0%, 100% {
                transform: scale(1);
                opacity: 0.4;
            }
            50% {
                transform: scale(1.2);
                opacity: 0.8;
            }
        }

        @keyframes centerDot {
            0% {
                box-shadow: 0 0 20px rgba(255, 165, 0, 0.8);
            }
            100% {
                box-shadow: 0 0 30px rgba(255, 165, 0, 1), 0 0 50px rgba(135, 206, 250, 0.5);
            }
        }

        /* --- Holographic Light Globe --- */
        .visual-navigation {
            position: fixed;
            top: 15px;
            left: 15px;
            width: 140px;
            height: 140px;
            z-index: 3000;
            perspective: 600px;
        }
        
        .nav-globe-container {
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            position: relative;
            animation: holoGlobeFloat 6s ease-in-out infinite;
        }
        
        .nav-globe {
            width: 100px;
            height: 100px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            transform-style: preserve-3d;
            border-radius: 50%;
            background: transparent;
            overflow: visible;
        }
        
        /* å…¨æ¯å…‰çƒå¤–å±‚ */
        .holo-sphere-outer {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, 
                rgba(167, 213, 255, 0.05) 0%, 
                rgba(135, 206, 250, 0.12) 30%, 
                rgba(15, 35, 60, 0.20) 60%,
                rgba(255, 165, 0, 0.08) 80%,
                transparent 100%);
            border: 2px solid rgba(135, 206, 250, 0.3);
            box-shadow: 
                0 0 35px rgba(135, 206, 250, 0.3),
                inset 0 0 25px rgba(167, 213, 255, 0.15),
                inset 0 0 50px rgba(255, 165, 0, 0.05);
            animation: holoSphereOuter 8s ease-in-out infinite;
        }
        
        /* å…¨æ¯å…‰çƒå†…å±‚ */
        .holo-sphere-inner {
            position: absolute;
            width: 75%;
            height: 75%;
            top: 12.5%;
            left: 12.5%;
            border-radius: 50%;
            background: radial-gradient(circle, 
                rgba(167, 213, 255, 0.15) 0%, 
                rgba(135, 206, 250, 0.08) 40%, 
                rgba(255, 165, 0, 0.05) 70%,
                transparent 85%);
            border: 1px solid rgba(135, 206, 250, 0.4);
            box-shadow: 
                0 0 20px rgba(135, 206, 250, 0.2),
                inset 0 0 15px rgba(167, 213, 255, 0.1);
            animation: holoSphereInner 5s ease-in-out infinite reverse;
        }
        
        /* å…‰æ³¢çº¹ç†å±‚ */
        .light-wave {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(
                transparent 0deg,
                rgba(135, 206, 250, 0.1) 45deg,
                transparent 90deg,
                rgba(167, 213, 255, 0.15) 135deg,
                transparent 180deg,
                rgba(135, 206, 250, 0.08) 225deg,
                transparent 270deg,
                rgba(167, 213, 255, 0.12) 315deg,
                transparent 360deg
            );
            animation: lightWaveRotate 12s linear infinite;
        }
        
        .light-wave::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(
                rgba(255, 165, 0, 0.05) 0deg,
                transparent 60deg,
                rgba(255, 165, 0, 0.1) 120deg,
                transparent 180deg,
                rgba(255, 165, 0, 0.08) 240deg,
                transparent 300deg,
                rgba(255, 165, 0, 0.06) 360deg
            );
            animation: lightWaveRotate 8s linear infinite reverse;
        }
        
        /* è„‰å†²å…‰ç¯ */
        .pulse-ring {
            position: absolute;
            border-radius: 50%;
            border: 1px solid rgba(135, 206, 250, 0.4);
            animation: pulsateRing 4s ease-in-out infinite;
        }
        
        .pulse-ring:nth-child(1) {
            width: 120%;
            height: 120%;
            top: -10%;
            left: -10%;
            animation-delay: 0s;
        }
        
        .pulse-ring:nth-child(2) {
            width: 90%;
            height: 90%;
            top: 5%;
            left: 5%;
            animation-delay: 1.5s;
            border-color: rgba(255, 165, 0, 0.3);
        }
        
        .pulse-ring:nth-child(3) {
            width: 60%;
            height: 60%;
            top: 20%;
            left: 20%;
            animation-delay: 3s;
            border-color: rgba(167, 213, 255, 0.5);
        }
        
        /* å…‰ç‚¹ï¼ˆå¡ç‰‡æŒ‡ç¤ºå™¨ï¼‰ */
        .nav-card-dot {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(255, 165, 0, 0.8);
            border-radius: 50%;
            transform-style: preserve-3d;
            transition: all 0.3s ease;
            box-shadow: 
                0 0 8px rgba(255, 165, 0, 0.6),
                0 0 16px rgba(255, 165, 0, 0.3);
            animation: dotFloat 3s ease-in-out infinite;
        }
        
        .nav-card-dot.center-dot {
            width: 6px;
            height: 6px;
            background: rgba(255, 215, 0, 1);
            box-shadow: 
                0 0 12px rgba(255, 215, 0, 0.8),
                0 0 24px rgba(255, 215, 0, 0.4),
                0 0 36px rgba(255, 215, 0, 0.2);
            animation: centerDotPulse 2s ease-in-out infinite, dotFloat 3s ease-in-out infinite;
        }
        
        .nav-card-dot:hover {
            transform: scale(2);
            z-index: 10;
            box-shadow: 
                0 0 16px rgba(255, 165, 0, 1),
                0 0 32px rgba(255, 165, 0, 0.6);
        }
        
        /* æ·±åº¦å¢å¼ºå±‚ */
        .holo-depth-enhancer {
            position: absolute;
            width: 90%;
            height: 90%;
            top: 5%;
            left: 5%;
            border-radius: 50%;
            background: 
                radial-gradient(ellipse 80% 60% at 25% 25%, 
                    rgba(167, 213, 255, 0.12) 0%, 
                    transparent 50%),
                radial-gradient(ellipse 60% 80% at 75% 75%, 
                    rgba(255, 165, 0, 0.08) 0%, 
                    transparent 50%);
            border: 1px solid rgba(135, 206, 250, 0.25);
            opacity: 0.8;
            animation: depthEnhancer 7s ease-in-out infinite;
        }
        
        /* å…¨æ¯ç½‘æ ¼çº¿ */
        .holo-grid {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: 
                linear-gradient(90deg, transparent 48%, rgba(135, 206, 250, 0.1) 49%, rgba(135, 206, 250, 0.1) 51%, transparent 52%),
                linear-gradient(0deg, transparent 48%, rgba(135, 206, 250, 0.1) 49%, rgba(135, 206, 250, 0.1) 51%, transparent 52%),
                radial-gradient(circle, transparent 20%, rgba(135, 206, 250, 0.05) 21%, rgba(135, 206, 250, 0.05) 22%, transparent 23%),
                radial-gradient(circle, transparent 40%, rgba(135, 206, 250, 0.05) 41%, rgba(135, 206, 250, 0.05) 42%, transparent 43%),
                radial-gradient(circle, transparent 60%, rgba(135, 206, 250, 0.05) 61%, rgba(135, 206, 250, 0.05) 62%, transparent 63%);
            animation: holoGridPulse 6s ease-in-out infinite;
        }
        
        .nav-globe-label {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-family: 'Teko', sans-serif;
            font-size: 0.75rem;
            color: var(--fui-primary);
            text-align: center;
            opacity: 0.6;
            letter-spacing: 0.1em;
            text-shadow: 0 0 10px rgba(135, 206, 250, 0.5);
            animation: labelGlow 4s ease-in-out infinite;
        }
        
        /* åŠ¨ç”»å®šä¹‰ */
        @keyframes holoGlobeFloat {
            0%, 100% { transform: translateY(0px) rotateZ(0deg); }
            25% { transform: translateY(-2px) rotateZ(0.5deg); }
            50% { transform: translateY(0px) rotateZ(1deg); }
            75% { transform: translateY(2px) rotateZ(0.5deg); }
        }
        
        @keyframes holoSphereOuter {
            0%, 100% { 
                opacity: 0.3;
                transform: scale(1);
                box-shadow: 0 0 30px rgba(135, 206, 250, 0.2);
            }
            50% { 
                opacity: 0.6;
                transform: scale(1.05);
                box-shadow: 0 0 40px rgba(135, 206, 250, 0.4);
            }
        }
        
        @keyframes holoSphereInner {
            0%, 100% { 
                opacity: 0.4;
                transform: scale(1);
            }
            50% { 
                opacity: 0.7;
                transform: scale(1.1);
            }
        }
        
        @keyframes lightWaveRotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes pulsateRing {
            0%, 100% { 
                opacity: 0.2;
                transform: scale(1);
            }
            50% { 
                opacity: 0.6;
                transform: scale(1.1);
            }
        }
        
        @keyframes centerDotPulse {
            0%, 100% { 
                box-shadow: 
                    0 0 12px rgba(255, 215, 0, 0.8),
                    0 0 24px rgba(255, 215, 0, 0.4);
                transform: scale(1);
            }
            50% { 
                box-shadow: 
                    0 0 20px rgba(255, 215, 0, 1),
                    0 0 40px rgba(255, 215, 0, 0.6),
                    0 0 60px rgba(255, 215, 0, 0.3);
                transform: scale(1.3);
            }
        }
        
        @keyframes dotFloat {
            0%, 100% { transform: translateZ(0px); }
            50% { transform: translateZ(5px); }
        }
        
        @keyframes holoGridPulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.7; }
        }
        
        @keyframes depthEnhancer {
            0%, 100% { 
                opacity: 0.6;
                transform: scale(1) rotateZ(0deg);
            }
            25% { 
                opacity: 0.8;
                transform: scale(1.02) rotateZ(90deg);
            }
            50% { 
                opacity: 0.9;
                transform: scale(1.05) rotateZ(180deg);
            }
            75% { 
                opacity: 0.8;
                transform: scale(1.02) rotateZ(270deg);
            }
        }
        
        @keyframes labelGlow {
            0%, 100% { 
                opacity: 0.6;
                text-shadow: 0 0 10px rgba(135, 206, 250, 0.5);
            }
            50% { 
                opacity: 0.9;
                text-shadow: 0 0 20px rgba(135, 206, 250, 0.8);
            }
        }

        /* --- Thumbnail Navigation Styles --- */
        .thumbnail-navigation {
            position: fixed;
            bottom: 15px;
            left: 15px;
            display: flex;
            align-items: flex-end;
            z-index: 3000;
            height: 60px;
            max-width: 60%;
            gap: 8px;
        }
        
        .nav-arrow {
            width: 36px;
            height: 36px;
            background: var(--fui-panel-bg);
            border: 1px solid var(--fui-border-color);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            color: var(--fui-primary);
            font-size: 16px;
            user-select: none;
        }
        
        .nav-arrow:hover {
            border-color: var(--fui-secondary);
            background: rgba(255, 165, 0, 0.1);
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(255, 165, 0, 0.2);
        }
        
        .nav-arrow:active {
            transform: scale(0.95);
        }
        
        .nav-arrow.rotating {
            pointer-events: none;
            opacity: 0.6;
        }
        
        .thumbnail-container {
            display: flex;
            align-items: flex-end;
            height: 60px;
            overflow-x: auto;
            overflow-y: visible;
            scrollbar-width: none;
            -ms-overflow-style: none;
            flex: 1;
            min-width: 0;
        }
        .thumbnail-container::-webkit-scrollbar {
            display: none;
        }
        
        .thumbnail-card {
            width: 45px;
            height: 32px;
            background: var(--fui-panel-bg);
            border: 1px solid var(--fui-border-color);
            border-radius: 3px;
            margin-right: -12px;
            cursor: pointer;
            position: relative;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(8px);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            font-size: 7px;
            color: var(--fui-primary);
            opacity: 1;
            transform: translateX(0px) scale(1);
        }
        
        .thumbnail-card.slide-out {
            opacity: 0;
            transform: translateX(-60px) scale(0.8);
            pointer-events: none;
        }
        
        .thumbnail-card.slide-in {
            animation: slideInFromLeft 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }
        
        @keyframes slideInFromLeft {
            0% {
                opacity: 0;
                transform: translateX(-60px) scale(0.8);
            }
            100% {
                opacity: 1;
                transform: translateX(0px) scale(1);
            }
        }
        
        .thumbnail-card:hover {
            transform: translateY(-3px) scale(1.05);
            border-color: var(--fui-secondary);
            margin-right: -8px;
            z-index: 10;
        }
        
        .thumbnail-card.active {
            transform: translateY(-8px) scale(1.1);
            border-color: var(--fui-secondary);
            box-shadow: 0 3px 10px rgba(255, 165, 0, 0.4);
            margin-right: -8px;
            z-index: 15;
        }
        
        .thumbnail-header {
            background: rgba(135, 206, 250, 0.1);
            padding: 2px 4px;
            font-size: 7px;
            border-bottom: 1px solid rgba(135, 206, 250, 0.2);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .thumbnail-content {
            padding: 2px 4px;
            font-size: 6px;
            line-height: 1.2;
            flex: 1;
            overflow: hidden;
            opacity: 0.7;
        }

        /* New styles for outline panel */
        .outline-panel {
            position: fixed;
            width: 250px;
            height: 0;
            background: var(--fui-panel-bg);
            border: 1px solid var(--fui-border-color);
            border-radius: 8px;
            backdrop-filter: blur(10px);
            overflow: hidden;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            opacity: 0;
            transform: translateY(20px) scale(0.95);
            transform-origin: bottom left;
            z-index: 2999;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 0 rgba(255, 165, 0, 0);
        }

        .outline-panel.active {
            height: 200px;
            opacity: 1;
            transform: translateY(0px) scale(1);
            box-shadow: 0 8px 25px rgba(255, 165, 0, 0.15), 0 3px 10px rgba(15, 35, 60, 0.3);
        }

        .outline-header {
            padding: 10px 15px;
            font-family: 'Teko', sans-serif;
            font-size: 1.1rem;
            color: var(--fui-secondary);
            border-bottom: 1px solid rgba(255, 165, 0, 0.2);
            text-align: center;
            letter-spacing: 0.05em;
        }

        .outline-list {
            list-style: none;
            padding: 10px 15px;
            margin: 0;
            overflow-y: auto;
            flex-grow: 1; /* Allow list to take available height */
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 165, 0, 0.5) transparent;
        }

        .outline-list::-webkit-scrollbar {
            width: 6px;
        }
        .outline-list::-webkit-scrollbar-track {
            background: transparent;
        }
        .outline-list::-webkit-scrollbar-thumb {
            background: rgba(255, 165, 0, 0.5);
            border-radius: 3px;
        }
        .outline-list::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 165, 0, 0.8);
        }

        .outline-list-item {
            padding: 8px 0;
            color: var(--fui-primary);
            font-size: 0.9rem;
            cursor: pointer;
            transition: color 0.2s ease, transform 0.2s ease;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .outline-list-item:hover {
            color: var(--fui-secondary);
            transform: translateX(5px);
        }

        /* Adjust thumbnail-navigation for outline panel */
        .thumbnail-navigation {
            position: fixed; /* Keep fixed */
            bottom: 15px;
            left: 15px;
            display: flex;
            align-items: flex-end;
            z-index: 3000;
            height: 60px; /* Base height */
            max-width: 60%;
            gap: 8px;
            /* Add transition for width/transform if needed */
            transition: width 0.4s ease-out, transform 0.4s ease-out;
        }

        /* Remove hidden-by-outline classes as they are no longer needed */
        /* .thumbnail-container.hidden-by-outline, .nav-arrow.hidden-by-outline are removed */

        /* ===== ç²’å­èƒŒæ™¯ç½‘ç»œæ•ˆæœ ===== */
        .particle-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
            overflow: hidden;
        }

        .particle-canvas {
            width: 100%;
            height: 100%;
        }

        /* ===== å³ä¸‹è§’JARVISåŠ¨æ€æ•ˆæœ ===== */
        .jarvis-corner-effect {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 200px;
            height: 200px;
            z-index: 2500;
            pointer-events: none;
        }

        .jarvis-corner-container {
            position: relative;
            width: 100%;
            height: 100%;
        }

        /* 3Då…‰çƒå®¹å™¨ */
        .corner-sphere-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 120px;
            height: 80px;
            border-radius: 50%;
            background: radial-gradient(ellipse at center, 
                rgba(135, 206, 250, 0.05) 0%, 
                rgba(135, 206, 250, 0.15) 40%, 
                transparent 70%);
            border: 1px solid rgba(135, 206, 250, 0.2);
            box-shadow: 0 0 20px rgba(135, 206, 250, 0.1);
        }

        .corner-sphere-canvas {
            width: 100%;
            height: 100%;
            border-radius: 50%;
        }

        /* ç§‘æŠ€å›¾æ ‡åŠ¨ç”» */
        .corner-tech-icons {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 180px;
            height: 180px;
        }

        .corner-tech-icon {
            position: absolute;
            width: 12px;
            height: 12px;
            opacity: 0;
            color: #87CEEB;
            filter: drop-shadow(0 0 3px currentColor);
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .corner-tech-icon.corner-animate-in {
            animation: cornerIconExpandIn 0.6s ease-out forwards;
        }

        .corner-tech-icon.corner-animate-out {
            animation: cornerIconExpandOut 0.4s ease-in forwards;
        }

        @keyframes cornerIconExpandIn {
            0% {
                opacity: 0;
                transform: scale(0) rotate(0deg);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotate(360deg);
            }
        }

        @keyframes cornerIconExpandOut {
            0% {
                opacity: 1;
                transform: scale(1) rotate(0deg);
            }
            100% {
                opacity: 0;
                transform: scale(0) rotate(-360deg);
            }
        }

    </style>
</head>
<body>
    <!-- ç²’å­èƒŒæ™¯ç½‘ç»œ -->
    <div class="particle-background">
        <canvas class="particle-canvas" id="particleCanvas"></canvas>
    </div>

    <div id="scene" class="perspective-container">
        <div id="origin" class="scene-origin">
            <!-- Connectors will be injected here -->
        </div>
    </div>
    


    <!-- Holographic Light Globe -->
    <div class="visual-navigation">
        <div id="navGlobeContainer" class="nav-globe-container">
            <div id="navGlobe" class="nav-globe">
                <!-- å…¨æ¯çƒä½“å±‚æ¬¡ç»“æ„ -->
                <div class="holo-sphere-outer"></div>
                <div class="holo-sphere-inner"></div>
                <div class="holo-depth-enhancer"></div>
                <div class="light-wave"></div>
                <div class="pulse-ring"></div>
                <div class="pulse-ring"></div>
                <div class="pulse-ring"></div>
                <div class="holo-grid"></div>
                <!-- Card dots will be generated dynamically -->
            </div>

        </div>
    </div>

    <div id="controls" class="controls-panel collapsed">
        <div class="controls-toggle-btn" id="controlsToggle" title="å¸ƒå±€è®¾ç½®">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" style="width: 16px; height: 16px;">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4" />
            </svg>
        </div>
        <div class="controls-content">
            <div class="flex items-center justify-between mb-1">
                <label for="radiusSlider" class="control-label mr-3">çƒä½“åŠå¾„</label>
                <span id="radiusValue" class="control-value">1.2</span>
            </div>
            <input type="range" id="radiusSlider" class="control-slider" min="0.3" max="2.5" step="0.1" value="1.2">
            <div class="flex items-center justify-between mt-2 mb-1">
                <label for="depthSlider" class="control-label mr-3">é«˜åº¦&çºµæ·±</label>
                <span id="depthValue" class="control-value">0.6</span>
            </div>
            <input type="range" id="depthSlider" class="control-slider" min="0.0" max="2.0" step="0.1" value="0.6">
            <div class="flex items-center justify-between mt-2 mb-1">
                <label for="scaleSlider" class="control-label mr-3">åœºæ™¯ç¼©æ”¾</label>
                <span id="scaleValue" class="control-value">0.5</span>
            </div>
            <input type="range" id="scaleSlider" class="control-slider" min="0.3" max="2.5" step="0.1" value="0.5">
        </div>
    </div>

    <div class="thumbnail-navigation">
        <div id="outlineToggle" class="nav-arrow" title="æ˜¾ç¤º/éšè—å¤§çº²">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" style="width: 18px; height: 18px;">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
        </div>
        <div id="prevArrow" class="nav-arrow" title="ä¸Šä¸€å¼ å¡ç‰‡">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" style="width: 18px; height: 18px;">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
            </svg>
        </div>
        <div id="thumbnailContainer" class="thumbnail-container">
            <!-- ç¼©ç•¥å›¾å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
        </div>
        <div id="nextArrow" class="nav-arrow" title="ä¸‹ä¸€å¼ å¡ç‰‡">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" style="width: 18px; height: 18px;">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
        </div>
    </div>

    <div id="outlinePanel" class="outline-panel">
        <div class="outline-header">å¡ç‰‡å¤§çº²</div>
        <ul id="outlineList" class="outline-list">
            <!-- å¤§çº²åˆ—è¡¨é¡¹å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
        </ul>
    </div>

    <!-- å³ä¸‹è§’JARVISåŠ¨æ€æ•ˆæœ -->
    <div class="jarvis-corner-effect">
        <div class="jarvis-corner-container">
            <!-- 3Då…‰çƒå®¹å™¨ -->
            <div class="corner-sphere-container">
                <canvas class="corner-sphere-canvas" id="cornerSphereCanvas" width="250" height="150"></canvas>
            </div>
            
            <!-- ç§‘æŠ€å›¾æ ‡åŠ¨ç”» -->
            <div class="corner-tech-icons" id="cornerTechIcons">
                <!-- å›¾æ ‡å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <script>
        // =================================================================
        // âš™ï¸ CONFIGURATION ZONE - é…ç½®åŒºåŸŸ 
        // =================================================================
        // è¯´æ˜ï¼šè¿™äº›æ˜¯ä¸»è¦çš„é…ç½®å‚æ•°ï¼Œå¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´
        // LLMæ›¿æ¢æŒ‡å—ï¼š
        // - å¡ç‰‡æ•°é‡ç°åœ¨å®Œå…¨ç”±contentTemplatesæ•°ç»„é•¿åº¦è‡ªåŠ¨å†³å®šï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®
        // - å…¶ä»–å‚æ•°ä¸€èˆ¬ä¸éœ€è¦ä¿®æ”¹ï¼Œé™¤éæœ‰ç‰¹æ®Šéœ€æ±‚
        // =================================================================
        
        const scene = document.getElementById('scene');
        const origin = document.getElementById('origin');

        // =================================================================
        // ğŸ”§ PHYSICS & LAYOUT PARAMETERS - ç‰©ç†å’Œå¸ƒå±€å‚æ•° 
        // =================================================================
        // è¯´æ˜ï¼šè¿™äº›å‚æ•°æ§åˆ¶ç•Œé¢çš„ç‰©ç†è¡Œä¸ºå’Œè§†è§‰å¸ƒå±€
        // âŒ ä¸å»ºè®®ä¿®æ”¹ï¼šè¿™äº›æ˜¯ç»è¿‡è°ƒä¼˜çš„å‚æ•°ï¼Œä¿®æ”¹å¯èƒ½å½±å“äº¤äº’ä½“éªŒ
        // =================================================================
        
        // Physics and animation parameters - ç‰©ç†åŠ¨ç”»å‚æ•°
        const damping = 0.92;                    // é˜»å°¼ç³»æ•°
        const rotationFactor = 0.3;              // æ—‹è½¬å› å­
        const springFactor = 0.04;               // å¼¹ç°§å› å­
        const springDamping = 0.85;              // å¼¹ç°§é˜»å°¼
        const focusSpringFactor = 0.1;           // èšç„¦å¼¹ç°§å› å­
        const focusSpringDamping = 0.75;         // èšç„¦å¼¹ç°§é˜»å°¼
        const focusScaleSpeed = 0.15;            // èšç„¦ç¼©æ”¾é€Ÿåº¦

        // Layout parameters - å¸ƒå±€å‚æ•°
        let radiusFactor = 1.2;      // çƒä½“åŠå¾„å› å­ï¼ˆå½±å“å¡ç‰‡åˆ†å¸ƒèŒƒå›´ï¼‰
        let ySpreadFactor = 0.6;     // Yè½´é«˜åº¦å’ŒZè½´çºµæ·±å› å­

        // =================================================================
        // ğŸ”„ STATE VARIABLES - çŠ¶æ€å˜é‡ 
        // =================================================================
        // è¯´æ˜ï¼šè¿™äº›æ˜¯ç³»ç»Ÿè¿è¡Œæ—¶çš„çŠ¶æ€å˜é‡
        // âŒ ä¸å»ºè®®ä¿®æ”¹ï¼šè¿™äº›æ˜¯å†…éƒ¨çŠ¶æ€ç®¡ç†ï¼Œä¿®æ”¹å¯èƒ½å¯¼è‡´åŠŸèƒ½å¼‚å¸¸
        // =================================================================
        
        // Core state variables - æ ¸å¿ƒçŠ¶æ€å˜é‡
        let windows = [];                       // çª—å£æ•°ç»„
        let thumbnails = [];                    // ç¼©ç•¥å›¾æ•°ç»„
        let navGlobeDots = [];                  // å¯¼èˆªçƒç‚¹æ•°ç»„
        let currentCenterIndex = 0;             // å½“å‰ä¸­å¿ƒå¡ç‰‡ç´¢å¼•
        let focusedWindow = null;               // å½“å‰èšç„¦çš„çª—å£
        
        // Rotation state - æ—‹è½¬çŠ¶æ€
        let isRotating = false;                 // æ˜¯å¦æ­£åœ¨æ—‹è½¬
        let rotationTargetIndex = -1;           // ç›®æ ‡æ—‹è½¬ç´¢å¼•
        let rotationStartTime = 0;              // æ—‹è½¬å¼€å§‹æ—¶é—´
        
        // Interaction state - äº¤äº’çŠ¶æ€
        let resizingWindow = null;              // æ­£åœ¨è°ƒæ•´å¤§å°çš„çª—å£
        let lastMouse = { x: 0, y: 0 };         // æœ€åé¼ æ ‡ä½ç½®
        let isRotatingScene = false;            // æ˜¯å¦æ­£åœ¨æ—‹è½¬åœºæ™¯
        let isResizing = false;                 // æ˜¯å¦æ­£åœ¨è°ƒæ•´å¤§å°
        let sceneRotation = { x: -20, y: 30 };  // åœºæ™¯æ—‹è½¬è§’åº¦
        let sceneVelocity = { x: 0, y: 0 };     // åœºæ™¯æ—‹è½¬é€Ÿåº¦
        let sceneScale = 0.5;                   // åœºæ™¯ç¼©æ”¾
        let targetScale = 0.5;                  // ç›®æ ‡ç¼©æ”¾
        // æš‚æ—¶æ³¨é‡Šæ‰å¾„å‘èœå•ç›¸å…³å˜é‡ - 2024å¹´æ›´æ–°
        // let longPressTimer = null;              // é•¿æŒ‰å®šæ—¶å™¨
        // let activeMenuWindow = null;            // æ´»åŠ¨èœå•çª—å£
        // const longPressDuration = 400;          // é•¿æŒ‰æŒç»­æ—¶é—´(ms)
        let startDragPos = { x: 0, y: 0 };      // å¼€å§‹æ‹–æ‹½ä½ç½®

        // =================================================================
        // ğŸ”„ DYNAMIC CONTENT ZONE - å¯åŠ¨æ€æ›¿æ¢çš„å†…å®¹åŒºåŸŸ
        // =================================================================
        // è¯´æ˜ï¼šè¿™ä¸ªæ•°ç»„åŒ…å«æ‰€æœ‰å¡ç‰‡çš„å†…å®¹æ¨¡æ¿ï¼Œæ˜¯ä¸»è¦çš„å†…å®¹æ›¿æ¢åŒºåŸŸ
        // LLMæ›¿æ¢æŒ‡å—ï¼š
        // - å¯ä»¥ä¿®æ”¹ï¼štitleï¼ˆæ ‡é¢˜ï¼‰ã€contentå‡½æ•°çš„è¿”å›å†…å®¹
        // - ä¸è¦ä¿®æ”¹ï¼šæ•°ç»„ç»“æ„ã€å¯¹è±¡ç»“æ„ { title: '', content: () => `` }
        // - å†…å®¹æ”¯æŒï¼šHTMLæ ‡ç­¾ã€CSSç±»åã€åŠ¨æ€å˜é‡
        // - æ•°é‡è¦æ±‚ï¼šå®Œå…¨è‡ªç”±ï¼æ·»åŠ æˆ–åˆ é™¤é¡¹ç›®ï¼Œå¡ç‰‡æ•°é‡ä¼šè‡ªåŠ¨é€‚é…
        // =================================================================
        
        const contentTemplates = [
    { 
        title: 'SEQ_01: ENTITY_DECODE', 
        content: () => `
            <p><strong>// ä¸»ä½“èº«ä»½è¯†åˆ«...</strong></p>
            <p>æ ¸å¿ƒå®šä½: <span class="text-yellow-400">ç²¾å¯†åˆ¶é€ å¹³å°å‹ä¼ä¸š</span></p>
            <p>è¿›åŒ–è·¯å¾„: ä»å•ä¸€èµ›é“è±ªèµŒï¼Œåˆ°è·¨é¢†åŸŸæŠ€æœ¯èµ‹èƒ½ã€‚</p>
            <p>å…³é”®è½¬æŠ˜ç‚¹: ä¸»åŠ¨è½¬å‹ï¼Œä»ä¾èµ–å›½å†…å¸‚åœºåˆ°æ”»åš<span class="code-variable">å›½é™…é¡¶çº§å®¢æˆ·</span>ï¼Œå¥ å®šæŠ€æœ¯ä¸ç®¡ç†åŸºçŸ³ã€‚</p>
            <p class="code-comment">-- ç»“è®ºï¼šå…¶çµé­‚æ˜¯æ·±æ€ç†Ÿè™‘çš„æˆ˜ç•¥æ¼”è¿›å²ï¼Œè€Œéæœºä¼šä¸»ä¹‰ã€‚ --</p>
        ` 
    },
    { 
        title: 'SEQ_02: STRATEGY_ANALYSIS', 
        content: () => `
            <p><strong>// ä¸šåŠ¡å¼•æ“åˆ†æ...</strong></p>
            <p><strong>å¼•æ“A: â€œåŸºæœ¬ç›˜â€ - æ¶ˆè´¹ç”µå­</strong></p>
            <ul><li>è§’è‰²: <span class="text-green-400">æŠ€æœ¯é”»é€ ç‚‰</span> & <span class="text-green-400">ç°é‡‘æµå¥¶ç‰›</span></li><li>æœºåˆ¶: é¡¶çº§å®¢æˆ·çš„ä¸¥è‹›è¦æ±‚ï¼Œå€’é€¼ææ–™ã€è‡ªåŠ¨åŒ–ã€å·¥è‰ºæŒç»­é¢†å…ˆã€‚</li></ul>
            <p><strong>å¼•æ“B: â€œæŠ¢æ»©é˜µåœ°â€ - æ–°èƒ½æº</strong></p>
            <ul><li>è§’è‰²: <span class="text-yellow-400">ç¬¬äºŒå¢é•¿æ</span></li><li>æœºåˆ¶: å°†æ¶ˆè´¹ç”µå­ç§¯ç´¯çš„æ ¸å¿ƒå·¥è‰ºï¼ˆå†²å‹ã€ç„Šæ¥ã€ç»„è£…ï¼‰<span class="code-string">â€œé™ç»´æ‰“å‡»â€</span>è‡³åŠ¨åŠ›ç”µæ± ç»“æ„ä»¶ç­‰é¢†åŸŸã€‚</li></ul>
            <p class="code-comment">-- ååŒé€»è¾‘ï¼šåŸºæœ¬ç›˜ä¸ºæŠ¢æ»©é˜µåœ°æä¾›æŠ€æœ¯ä¸èµ„é‡‘ï¼Œå½¢æˆå¼ºå¤§å†…å¾ªç¯ã€‚ --</p>
        ` 
    },
    { 
        title: 'SEQ_03: COMPASS_METRIC_01', 
        content: () => `
            <p><strong>// è§£ç ç‹¬ç‰¹è§‚å¯Ÿè§†è§’ 1...</strong></p>
            <p><strong>æ‘’å¼ƒæŒ‡æ ‡:</strong> å‡€åˆ©æ¶¦ (å› å·¨é¢æŠ˜æ—§è€Œä¸¥é‡å¤±çœŸ)</p>
            <p><strong>æ ¸å¿ƒæŒ‡æ ‡:</strong> â€œèµ„æœ¬å¼€æ”¯åˆ°ç°é‡‘æµâ€çš„<span class="code-variable">è½¬åŒ–æ•ˆç‡</span></p>
            <p><strong>å…³é”®ä¿¡å· (2023):</strong> è¥æ”¶ä¸‹é™9.7%ï¼Œä½†ç»è¥ç°é‡‘æµ(OCF)é£™å‡<span class="text-green-400">138%</span>è‡³22.28äº¿ã€‚</p>
            <p class="code-comment">-- ç»“è®ºï¼šè¿™æ˜¯å‰æœŸèµ„æœ¬æŠ•å…¥æˆåŠŸè½¬åŒ–ä¸ºä¼˜è´¨ç°é‡‘æµçš„é“è¯ï¼Œæ¯”åˆ©æ¶¦è½¬æ­£æ›´å…·å‰ç»æ€§ã€‚ --</p>
        ` 
    },
    { 
        title: 'SEQ_04: COMPASS_METRIC_02', 
        content: () => `
            <p><strong>// è§£ç ç‹¬ç‰¹è§‚å¯Ÿè§†è§’ 2...</strong></p>
            <p><strong>æ‘’å¼ƒæ ‡ç­¾:</strong> â€œç”µå­é›¶ä»¶å‚â€ æˆ– â€œæ±½è½¦é…ä»¶å‚â€</p>
            <p><strong>æ ¸å¿ƒèµ„äº§:</strong> å¯è¿ç§»å¤ç”¨çš„<span class="code-variable">æ ¸å¿ƒå·¥è‰ºå¹³å°</span></p>
            <p><strong>è¯„ä¼°æ¡†æ¶:</strong> å·¥è‰ºå¹³å°è½¬åŒ–ç‡ (è€ƒé‡æŠ€æœ¯æ·±åº¦ä¸åº”ç”¨å¹¿åº¦)</p>
            <p><strong>å®ä¾‹ä½è¯:</strong> ä¸ºä¸‰æ˜ŸS24å¼€å‘çš„<span class="text-yellow-400">é’›åˆé‡‘åŠ å·¥æŠ€æœ¯</span>ï¼Œå…·å¤‡å‘æ±½è½¦/èˆªç©ºéƒ¨ä»¶è¿ç§»çš„å·¨å¤§æ½œåŠ›ã€‚</p>
            <p class="code-comment">-- ç»“è®ºï¼šé€šè¿‡â€œåˆ›æ–°çš„è§„æ¨¡ç»æµâ€ï¼Œå®ç°è¿œè¶…åŒè¡Œçš„èµ„æœ¬æ•ˆç‡ã€‚ --</p>
        ` 
    },
    { 
        title: 'SEQ_05: COMPASS_METRIC_03', 
        content: () => `
            <p><strong>// è§£ç ç‹¬ç‰¹è§‚å¯Ÿè§†è§’ 3...</strong></p>
            <p><strong>åå¸¸ç°è±¡ (2023):</strong> æ”¶å…¥é™9.7%ï¼Œå‡€åˆ©å´å¢102%ã€‚</p>
            <p><strong>æ ¸å¿ƒä¿¡å·:</strong> OCFä¸å‡€åˆ©æ¶¦çš„å·¨å¤§æ­£å‘<span class="code-variable">â€œå‰ªåˆ€å·®â€</span></p>
            <p><strong>æ•°æ®é€è§† (2023):</strong></p>
            <ul><li>ç»è¥ç°é‡‘æµ (OCF): <span class="text-green-400">22.28 äº¿å…ƒ</span></li><li>å½’æ¯å‡€åˆ©æ¶¦: <span class="text-yellow-400">0.86 äº¿å…ƒ</span></li><li>å‰ªåˆ€å·®: <span class="code-variable">è¶…è¿‡ 21 äº¿å…ƒ</span></li></ul>
            <p class="code-comment">-- ç»“è®ºï¼šè¿™ä¸ªå·®é¢æ˜¯æœªæ¥åˆ©æ¶¦çš„â€œæ½œåœ¨å¼¹æ€§â€ï¼Œè´¦é¢åˆ©æ¶¦çš„å¤§å¹…å›å‡åªæ˜¯æ—¶é—´é—®é¢˜ã€‚ --</p>
        ` 
    },
    { 
        title: 'SEQ_06: DATA_VERIFICATION', 
        content: () => `
            <p><strong>// æ ¸å¿ƒæ•°æ®äº¤å‰éªŒè¯...</strong></p>
            <p><strong>è·¯å¾„å›¾éªŒè¯:</strong></p>
            <ul><li><span class="code-variable">2021å¹´</span>: èµ„æœ¬å¼€æ”¯è¾¾åˆ°é¡¶å³° (17.82äº¿)ï¼Œå¯¹åº”æ–°èƒ½æºåŸºåœ°å¯†é›†æŠ•å»ºæœŸã€‚</li><li><span class="code-variable">2023å¹´</span>: ç»è¥ç°é‡‘æµçˆ†å‘å¢é•¿ (22.28äº¿)ï¼ŒæˆåŠŸå®Œæˆè½¬åŒ–ã€‚</li></ul>
            <p><strong>å¢é•¿å¼•æ“éªŒè¯ (æ–°èƒ½æºä¸šåŠ¡æ”¶å…¥å æ¯”):</strong></p>
            <ul><li>2021: <span class="text-yellow-400">10.25%</span> â†’ 2023: <span class="text-green-400">25.80%</span></li></ul>
            <p class="code-comment">-- ç»“è®ºï¼šæ•°æ®é—­ç¯å½¢æˆï¼Œæˆ˜ç•¥å™äº‹å¾—åˆ°è´¢åŠ¡çš„å¼ºåŠ›æ”¯æ’‘ã€‚ --</p>
        ` 
    },
    { 
        title: 'SEQ_07: FUTURE_PROJECTION', 
        content: () => `
            <p><strong>// æ¨æ¼”æœªæ¥å‘å±•ç« èŠ‚...</strong></p>
            <p><strong>å½“å‰é˜¶æ®µ:</strong> ä¸ºç‰¹å®šäº§å“åˆ¶é€ é›¶éƒ¨ä»¶ã€‚</p>
            <p><strong>æœªæ¥æ„¿æ™¯:</strong> <span class="text-yellow-400">å¹³å°èµ‹èƒ½è€…</span></p>
            <p><strong>æœåŠ¡å¯¹è±¡:</strong> ä»»ä½•éœ€è¦å¤§è§„æ¨¡ã€é«˜ç²¾åº¦ã€å¤æ‚é›¶éƒ¨ä»¶çš„å°–ç«¯è¡Œä¸š (äººå½¢æœºå™¨äººã€é«˜ç«¯åŒ»ç–—ã€èˆªç©ºèˆªå¤©ç­‰)ã€‚</p>
            <p><strong>æ ¸å¿ƒé€»è¾‘:</strong> å®¢æˆ·çš„äº§å“å½¢æ€ä¸å†é‡è¦ï¼Œå› ä¸ºå…¬å¸çš„<span class="code-string">å·¥è‰ºå¹³å°æ˜¯æ™®é€‚çš„</span>ã€‚</p>
            <p><strong>æˆ˜ç•¥åŠ¨ä½œ:</strong> åŠ é€Ÿå…¨çƒåŒ–å¸ƒå±€ (è¶Šå—ã€å¢¨è¥¿å“¥ã€æ¬§æ´²)ï¼Œå°†åˆ¶é€ å¹³å°å»¶ä¼¸è‡³å…¨çƒã€‚</p>
        ` 
    },
    { 
        title: 'SEQ_08: RISK_MATRIX', 
        content: () => `
            <p><strong>// æ­£åœ¨æ‰«ææ½œåœ¨é£é™©...</strong></p>
            <p><strong>é£é™© 1: <span class="text-red-400">åŒçº¿ä½œæˆ˜çš„å‹åŠ›</span></strong></p>
            <ul><li>æè¿°: æ¶ˆè´¹ç”µå­ï¼ˆæé€Ÿè¿­ä»£ï¼‰ä¸æ–°èƒ½æºï¼ˆé•¿æœŸç¨³å®šï¼‰ä¸¤ä¸ªè¿¥å¼‚æˆ˜åœºçš„å¹³è¡¡ï¼Œå¯¹ç®¡ç†ä¸èµ„æœ¬æ˜¯å·¨å¤§è€ƒéªŒã€‚</li></ul>
            <p><strong>é£é™© 2: <span class="text-red-400">â€œé‡‘è‰²æ‰‹é“â€çš„é£é™©</span></strong></p>
            <ul><li>æè¿°: æˆåŠŸé«˜åº¦ä¾èµ–å°‘æ•°é¡¶çº§å®¢æˆ·ï¼ˆè‹¹æœ/ç‰¹æ–¯æ‹‰/å®å¾·æ—¶ä»£ç­‰ï¼‰ï¼Œæ„æˆæ˜¾è‘—çš„å®¢æˆ·é›†ä¸­åº¦é£é™©ã€‚</li></ul>
            <p><strong>é£é™© 3: <span class="text-red-400">æŠ€æœ¯è¿­ä»£çš„é€Ÿåº¦</span></strong></p>
            <ul><li>æè¿°: ç²¾å¯†åˆ¶é€ æŠ€æœ¯è¿­ä»£æå¿«ï¼Œæ¯å¹´è¶…10äº¿çš„ç ”å‘æŠ•å…¥æ˜¯å…³ä¹ç”Ÿå­˜çš„å¿…éœ€å“ï¼Œå¿…é¡»æ¯”å¸‚åœºæ›´å¿«åˆ›æ–°ã€‚</li></ul>
        ` 
    }
];
        
        // =================================================================
        // ğŸ“ CONTENT STYLING GUIDE - å†…å®¹æ ·å¼æŒ‡å—
        // =================================================================
        // å¯ç”¨çš„CSSç±»åï¼ˆåœ¨contentå‡½æ•°ä¸­ä½¿ç”¨ï¼‰ï¼š
        // æ–‡æœ¬é¢œè‰²ï¼š.text-green-400, .text-yellow-400, .text-red-400, .text-blue-400
        // ä»£ç æ ·å¼ï¼š.code-keyword, .code-string, .code-comment, .code-variable
        // å…¶ä»–æ ·å¼ï¼š.font-bold, .animate-pulse
        // HTMLæ ‡ç­¾ï¼š<p>, <span>, <br>, è¡¨æƒ…ç¬¦å·ç­‰
        // 
        // æ¨¡æ¿å†…å®¹å»ºè®®ï¼š
        // - ä½¿ç”¨<p>æ ‡ç­¾åˆ†æ®µ
        // - ç”¨<span class="xxx">ä¸ºé‡è¦ä¿¡æ¯æ·»åŠ é¢œè‰²
        // - æ”¯æŒåŠ¨æ€JavaScriptå˜é‡ï¼š${Date.now()}, ${Math.random()}ç­‰
        // - å¯ä»¥åŒ…å«è¡¨æƒ…ç¬¦å·ã€ç‰¹æ®Šå­—ç¬¦å¢å¼ºè§†è§‰æ•ˆæœ
        // =================================================================

        // =================================================================
        // ğŸ§® CORE CALCULATION FUNCTIONS - æ ¸å¿ƒè®¡ç®—å‡½æ•°
        // =================================================================
        // è¯´æ˜ï¼šè¿™äº›å‡½æ•°è´Ÿè´£3Då¸ƒå±€è®¡ç®—å’Œæ•°å­¦è¿ç®—
        // âŒ ä¸å»ºè®®ä¿®æ”¹ï¼šè¿™äº›æ˜¯æ ¸å¿ƒç®—æ³•ï¼Œä¿®æ”¹å¯èƒ½ç ´å3Dæ•ˆæœ
        // =================================================================
        
        function calculateOriginalPosition(i) {
            const radius = Math.min(window.innerWidth, window.innerHeight) * radiusFactor;
            
            // çƒçŠ¶åˆ†å¸ƒï¼šä¿æŒç¾è§‚çš„åŒæ—¶ç¡®ä¿å¯¼èˆªå¯é¢„æµ‹æ€§
            const y = 1 - (i / (contentTemplates.length - 1)) * 2; // Yä»1åˆ°-1çš„çº¿æ€§åˆ†å¸ƒ
            const radiusAtY = Math.sqrt(1 - y * y); // åœ¨è¯¥Yé«˜åº¦çš„åœ†åŠå¾„
            
            // æ··åˆæ–¹å¼ï¼šåŸºç¡€å‡åŒ€åˆ†å¸ƒ + é»„é‡‘è§’åº¦åç§»ï¼Œä¿æŒçƒçŠ¶ç¾æ„Ÿ
            const baseAngleStep = (2 * Math.PI) / contentTemplates.length; // åŸºç¡€å‡åŒ€è§’åº¦
            const goldenOffset = Math.PI * (3 - Math.sqrt(5)) * 0.3; // è½»å¾®çš„é»„é‡‘è§’åº¦åç§»
            const theta = i * baseAngleStep + i * goldenOffset;
            
            // åŸºç¡€çƒé¢åæ ‡
            const baseX = Math.cos(theta) * radiusAtY * radius;
            const baseZ = Math.sin(theta) * radiusAtY * radius;
            
            // Yè½´åº”ç”¨çºµæ·±å› å­
            const finalY = y * radius * ySpreadFactor;
            
            // Zè½´æ·»åŠ å‰åå±‚æ¬¡å˜åŒ–
            const zDepthOffset = Math.sin(i * 1.618) * radius * ySpreadFactor * 0.3;
            const finalZ = baseZ + zDepthOffset;
            
            return { x: baseX, y: finalY, z: finalZ };
        }

        // æš‚æ—¶æ³¨é‡Šæ‰å¾„å‘èœå•åˆ›å»ºå‡½æ•° - 2024å¹´æ›´æ–°
        /*
        function createRadialMenu() {
            // Function remains unchanged
            const menuContainer = document.createElement('div');
            menuContainer.className = 'radial-menu-container';
            const arc = document.createElement('div');
            arc.className = 'radial-menu-arc';
            menuContainer.appendChild(arc);
            const menuItems = [
                { icon: 'M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2H5a2 2 0 00-2 2v2', name: 'Analyze' },
                { icon: 'M13 10V3L4 14h7v7l9-11h-7z', name: 'Teleport' },
                { icon: 'M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z', name: 'Track' },
                { icon: 'M6 18L18 6M6 6l12 12', name: 'Close' }
            ];
            const angleStep = 180 / (menuItems.length - 1);
            const radius = 85;
            menuItems.forEach((item, index) => {
                const menuItem = document.createElement('div');
                menuItem.className = 'radial-menu-item';
                const angle = -90 + (angleStep * index);
                const rad = angle * (Math.PI / 180);
                const x = Math.cos(rad) * radius;
                const y = Math.sin(rad) * radius;
                menuItem.style.setProperty('--tx', `${x}px`);
                menuItem.style.setProperty('--ty', `${y}px`);
                menuItem.style.setProperty('--delay', `${0.15 + index * 0.06}s`);
                menuItem.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="${item.icon}" /></svg>`;
                menuItem.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const winState = windows.find(w => w.el.contains(e.target));
                    console.log(`Clicked on: ${item.name} for window: ${winState ? winState.id : 'unknown'}`);
                    if (item.name === 'Close' && winState) {
                        closeWindow(winState);
                    } else {
                        hideRadialMenu();
                    }
                });
                menuContainer.appendChild(menuItem);
            });
            return menuContainer;
        }
        */

        // =================================================================
        // ğŸ—ï¸ UI CREATION FUNCTIONS - UIåˆ›å»ºå‡½æ•°
        // =================================================================
        // è¯´æ˜ï¼šè¿™äº›å‡½æ•°è´Ÿè´£åˆ›å»ºå’Œç®¡ç†ç•Œé¢å…ƒç´ 
        // âŒ å¤§éƒ¨åˆ†ä¸å»ºè®®ä¿®æ”¹ï¼šè¿™äº›æ˜¯ç•Œé¢ç»“æ„é€»è¾‘
        // ğŸ”„ å¯å°å¹…è°ƒæ•´ï¼šçª—å£å¤§å°ã€æ ·å¼ç±»åç­‰è§†è§‰å±æ€§
        // =================================================================
        
        function createWindow(i) {
            // Function remains unchanged
            const template = contentTemplates[i % contentTemplates.length];
            const win = document.createElement('div');
            win.id = `window-${i}`;
            win.className = 'fui-window';
            let cardWidth = window.innerWidth * (Math.random() * 0.05 + 0.22);
            let cardHeight = cardWidth * 0.8;
            const originalPos = calculateOriginalPosition(i);
            
            win.innerHTML = `
                <div class="fui-header">${template.title}</div>
                <div class="marker-dots">
                    <div class="marker-dot dot-pink" data-color="pink"></div>
                    <div class="marker-dot dot-blue" data-color="blue"></div>
                    <div class="marker-dot dot-yellow" data-color="yellow"></div>
                </div>
                <div class="fui-content">...</div>
                <div class="resize-handle"></div>`;

            // æš‚æ—¶æ³¨é‡Šæ‰å¾„å‘èœå•åˆ›å»º - 2024å¹´æ›´æ–°
            // const radialMenu = createRadialMenu();
            // win.appendChild(radialMenu);
            origin.appendChild(win);

            const windowState = {
                id: win.id, el: win, 
                // radialMenu: radialMenu,  // æš‚æ—¶æ³¨é‡Šæ‰å¾„å‘èœå• - 2024å¹´æ›´æ–°
                width: cardWidth, height: cardHeight,
                x: originalPos.x, y: originalPos.y, z: originalPos.z, scale: 1.0,
                vx: 0, vy: 0, vz: 0,
                targetX: originalPos.x, targetY: originalPos.y, targetZ: originalPos.z,
                targetScale: 1.0,
                originalX: originalPos.x, originalY: originalPos.y, originalZ: originalPos.z,
                isFocusing: false,
                highlightColor: null
            };
            windows.push(windowState);
            updateContent(windowState);
        }

        function createNavGlobeDots() {
            // æ¸…ç©ºç°æœ‰å¯¼èˆªçƒç‚¹
            navGlobeDots.forEach(dot => dot.el.remove());
            navGlobeDots = [];

            const navGlobe = document.getElementById('navGlobe');
            const globeRadius = 40; // å¯¼èˆªçƒçš„åŠå¾„ï¼ˆ100pxçƒä½“çš„50pxåŠå¾„ï¼‰
            
            windows.forEach((win, index) => {
                const dotEl = document.createElement('div');
                dotEl.className = 'nav-card-dot';
                
                // è®¡ç®—å¡ç‰‡åœ¨å¯¼èˆªçƒä¸Šçš„ä½ç½®ï¼ˆä½¿ç”¨ä¸ä¸»åœºæ™¯ç›¸åŒçš„å¸ƒå±€é€»è¾‘ï¼‰
                const y = 1 - (index / (contentTemplates.length - 1)) * 2; // Yä»1åˆ°-1
                const radiusAtY = Math.sqrt(1 - y * y);
                const baseAngleStep = (2 * Math.PI) / contentTemplates.length;
                const goldenOffset = Math.PI * (3 - Math.sqrt(5)) * 0.3;
                const theta = index * baseAngleStep + index * goldenOffset;
                
                const x = Math.cos(theta) * radiusAtY * globeRadius * 0.8; // ç¨å¾®ç¼©å°ï¼Œè®©ç‚¹åœ¨çƒä½“å†…éƒ¨
                const z = Math.sin(theta) * radiusAtY * globeRadius * 0.8;
                const dotY = y * globeRadius * ySpreadFactor; // ä¸ä¸»åœºæ™¯çš„ySpreadFactorå¯¹åº”
                
                // è®¾ç½®ç‚¹çš„ä½ç½®
                dotEl.style.left = `${50 + x}px`; // 50pxæ˜¯çƒå¿ƒåç§»
                dotEl.style.top = `${50 + dotY}px`;
                dotEl.style.transform = `translateX(-50%) translateY(-50%) translateZ(${z}px)`;
                dotEl.style.zIndex = Math.floor(z + 200); // Z-indexåŸºäºzåæ ‡ï¼Œç¡®ä¿åœ¨çƒä½“å±‚ä¹‹ä¸Š
                
                // æ·»åŠ éšæœºå»¶è¿Ÿçš„æµ®åŠ¨åŠ¨ç”»
                dotEl.style.animationDelay = `${index * 0.2}s`;
                
                // æ·»åŠ ç‚¹å‡»äº‹ä»¶æ¥å¯¼èˆªåˆ°å¯¹åº”å¡ç‰‡
                dotEl.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log(`ç‚¹å‡»å…¨æ¯å¯¼èˆªç‚¹ ${index}`);
                    centerCardToEquator(index);
                });
                
                // æ·»åŠ æ‚¬åœæç¤º
                dotEl.title = contentTemplates[index % contentTemplates.length].title;
                
                navGlobe.appendChild(dotEl);
                navGlobeDots.push({ 
                    el: dotEl, 
                    index: index, 
                    x: x, 
                    y: dotY, 
                    z: z 
                });
            });
            
            updateNavGlobeStates();
        }

        function updateNavGlobeStates() {
            // æ›´æ–°å¯¼èˆªçƒç‚¹çš„çŠ¶æ€
            navGlobeDots.forEach((dot, index) => {
                if (index === currentCenterIndex) {
                    dot.el.classList.add('center-dot');
                } else {
                    dot.el.classList.remove('center-dot');
                }
            });
        }

        function updateNavGlobeRotation() {
            const navGlobe = document.getElementById('navGlobe');
            if (navGlobe) {
                // è®¡ç®—æ™ºèƒ½æ ¡å‡†è§’åº¦
                const adjustedRotation = calculateSmartGlobeRotation();
                navGlobe.style.transform = `translate(-50%, -50%) rotateX(${adjustedRotation.x}deg) rotateY(${adjustedRotation.y}deg)`;
            }
        }

        // ç”¨äºå­˜å‚¨å¹³æ»‘è¿‡æ¸¡çš„ç›®æ ‡è§’åº¦
        let globeTargetRotation = { x: 0, y: 0 };
        let globeCurrentRotation = { x: 0, y: 0 };
        let globeTransitionSpeed = 0.12; // æ§åˆ¶è¿‡æ¸¡å¹³æ»‘åº¦

        function calculateSmartGlobeRotation() {
            // åŸºç¡€è·Ÿéšä¸»åœºæ™¯æ—‹è½¬
            let targetX = sceneRotation.x;
            let targetY = sceneRotation.y;
            
            // æ™ºèƒ½æ ¡å‡†ï¼šå½“çƒä½“æ¥è¿‘ä¾§é¢è§†è§’æ—¶è¿›è¡Œå¾®è°ƒ
            const normalizedY = ((targetY % 360) + 360) % 360;
            
            // å®šä¹‰å±é™©è§’åº¦èŒƒå›´ï¼ˆæ¥è¿‘ä¾§é¢ï¼‰
            const sideViewAngles = [90, 270]; // 90åº¦å’Œ270åº¦æ˜¯å®Œå…¨ä¾§é¢
            const correctionRange = 30; // åœ¨Â±30åº¦èŒƒå›´å†…å¼€å§‹æ ¡å‡†
            const maxCorrection = 25; // æœ€å¤§æ ¡å‡†è§’åº¦
            
            let isCorrectingAngle = false;
            
            for (const sideAngle of sideViewAngles) {
                const angleDiff = Math.min(
                    Math.abs(normalizedY - sideAngle),
                    Math.abs(normalizedY - sideAngle + 360),
                    Math.abs(normalizedY - sideAngle - 360)
                );
                
                if (angleDiff <= correctionRange) {
                    isCorrectingAngle = true;
                    
                    // ä½¿ç”¨å¹³æ»‘çš„æ ¡å‡†å‡½æ•°
                    const correctionStrength = Math.sin((1 - angleDiff / correctionRange) * Math.PI / 2);
                    const correctionAmount = correctionStrength * maxCorrection;
                    
                    // ç¡®å®šæ ¡å‡†æ–¹å‘ï¼ˆé¿å¼€ä¾§é¢ï¼‰
                    let correctionDirection = 1;
                    if (sideAngle === 90) {
                        correctionDirection = normalizedY < 90 ? 1 : -1;
                    } else if (sideAngle === 270) {
                        correctionDirection = normalizedY < 270 ? 1 : -1;
                    }
                    
                    // åº”ç”¨Yè½´æ ¡å‡†
                    targetY += correctionDirection * correctionAmount;
                    
                    // æ·»åŠ åŠ¨æ€Xè½´è°ƒæ•´ä»¥å¢å¼ºç«‹ä½“æ„Ÿ
                    const dynamicXCorrection = Math.sin(Date.now() * 0.001) * correctionStrength * 8;
                    const baseXCorrection = correctionStrength * 12;
                    
                    if (Math.abs(targetX) < 45) { // åœ¨åˆç†èŒƒå›´å†…è°ƒæ•´Xè½´
                        targetX += baseXCorrection + dynamicXCorrection;
                    }
                    
                    // è°ƒæ•´è¿‡æ¸¡é€Ÿåº¦ï¼šæ ¡å‡†æ—¶æ›´å¿«ï¼Œæ­£å¸¸æ—¶æ›´æ…¢
                    globeTransitionSpeed = Math.min(0.25, 0.12 + correctionStrength * 0.13);
                    
                    break; // åªåº”ç”¨ä¸€æ¬¡æ ¡å‡†
                }
            }
            
            // å¦‚æœæ²¡æœ‰åœ¨æ ¡å‡†ï¼Œæ¢å¤æ­£å¸¸è¿‡æ¸¡é€Ÿåº¦
            if (!isCorrectingAngle) {
                globeTransitionSpeed = Math.max(0.08, globeTransitionSpeed - 0.01);
            }
            
            // é™åˆ¶è§’åº¦èŒƒå›´
            targetX = Math.max(-80, Math.min(80, targetX));
            
            // æ›´æ–°ç›®æ ‡è§’åº¦
            globeTargetRotation.x = targetX;
            globeTargetRotation.y = targetY;
            
            // å¹³æ»‘è¿‡æ¸¡åˆ°ç›®æ ‡è§’åº¦
            globeCurrentRotation.x += (globeTargetRotation.x - globeCurrentRotation.x) * globeTransitionSpeed;
            globeCurrentRotation.y += (globeTargetRotation.y - globeCurrentRotation.y) * globeTransitionSpeed;
            
            return { 
                x: globeCurrentRotation.x, 
                y: globeCurrentRotation.y 
            };
        }

        function createThumbnails() {
            // æ¸…ç©ºç°æœ‰ç¼©ç•¥å›¾
            thumbnails.forEach(t => t.el.remove());
            thumbnails = [];

            const thumbnailContainer = document.getElementById('thumbnailContainer');
            
            windows.forEach((win, index) => {
                const thumbnailEl = document.createElement('div');
                thumbnailEl.className = 'thumbnail-card';
                
                // å¦‚æœå¤§çº²é¢æ¿æ˜¯å¼€å¯çš„ï¼Œåˆå§‹çŠ¶æ€åº”è¯¥æ˜¯éšè—çš„
                if (isOutlinePanelOpen) {
                    thumbnailEl.classList.add('slide-out');
                }
                
                const template = contentTemplates[index % contentTemplates.length];
                const shortContent = template.content().replace(/<[^>]*>/g, '').substring(0, 50) + '...';
                
                thumbnailEl.innerHTML = `
                    <div class="thumbnail-header">${template.title}</div>
                    <div class="thumbnail-content">${shortContent}</div>
                `;
                
                thumbnailEl.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log(`ç‚¹å‡»äº†ç¼©ç•¥å›¾ ${index}`);
                    centerCardToEquator(index);
                });
                
                thumbnailContainer.appendChild(thumbnailEl);
                thumbnails.push({ 
                    el: thumbnailEl, 
                    index: index, 
                    windowState: win 
                });
            });
            
            updateThumbnailStates();
        }
        
        function closeWindow(winState) {
            if (!winState) return;
            winState.el.style.opacity = '0';
            winState.el.style.pointerEvents = 'none';
            setTimeout(() => {
                winState.el.remove();
                windows = windows.filter(w => w.id !== winState.id);
                
                if (focusedWindow && focusedWindow.id === winState.id) focusedWindow = null;
                // æš‚æ—¶æ³¨é‡Šæ‰å¾„å‘èœå•çª—å£æ¸…ç† - 2024å¹´æ›´æ–°
                // if (activeMenuWindow && activeMenuWindow.id === winState.id) activeMenuWindow = null;
                
                createThumbnails();
            }, 500);
        }

        function rotateToCard(targetIndex) {
            console.log(`å°è¯•æ—‹è½¬åˆ°å¡ç‰‡ ${targetIndex}, å½“å‰ä¸­å¿ƒ: ${currentCenterIndex}`);
            
            if (targetIndex < 0 || targetIndex >= windows.length) {
                console.log('æ— æ•ˆçš„ç›®æ ‡ç´¢å¼•');
                return;
            }
            
            // ç«‹å³æ›´æ–°ä¸­å¿ƒç´¢å¼•
            currentCenterIndex = targetIndex;
            
            // è®¾ç½®æ—‹è½¬çŠ¶æ€
            isRotating = true;
            rotationTargetIndex = targetIndex;
            rotationStartTime = Date.now();
            updateNavigationState();
            
            // ä½¿ç”¨ä¸å¸ƒå±€ç›¸åŒçš„è§’åº¦è®¡ç®—ï¼Œç¡®ä¿å‡†ç¡®å±…ä¸­
            const baseAngleStep = (2 * Math.PI) / contentTemplates.length;
            const goldenOffset = Math.PI * (3 - Math.sqrt(5)) * 0.3;
            const targetTheta = targetIndex * baseAngleStep + targetIndex * goldenOffset;
            
            // è®¡ç®—ç›®æ ‡å¡ç‰‡çš„Yä½ç½®
            const targetY = 1 - (targetIndex / (contentTemplates.length - 1)) * 2;
            
            // è®¡ç®—ç›®æ ‡æ—‹è½¬è§’åº¦
            const targetYRotation = -targetTheta * (180 / Math.PI);
            const targetXRotation = -Math.asin(targetY) * (180 / Math.PI) * 1.0; // å¢åŠ Xè½´æ—‹è½¬å¹…åº¦
            
            console.log(`ç›®æ ‡å¡ç‰‡ ${targetIndex}: Y=${targetY.toFixed(3)}, targetTheta=${(targetTheta * 180/Math.PI).toFixed(1)}Â°`);
            console.log(`è®¡ç®—æ—‹è½¬: Yè½´${targetYRotation.toFixed(1)}Â°, Xè½´${targetXRotation.toFixed(1)}Â°`);
            
            // è®¡ç®—æœ€çŸ­è·¯å¾„çš„è§’åº¦å·®
            let yAngleDiff = targetYRotation - sceneRotation.y;
            let xAngleDiff = targetXRotation - sceneRotation.x;
            
            console.log(`å½“å‰åœºæ™¯: Y=${sceneRotation.y.toFixed(1)}Â°, X=${sceneRotation.x.toFixed(1)}Â°`);
            console.log(`è§’åº¦å·®: Î”Y=${yAngleDiff.toFixed(1)}Â°, Î”X=${xAngleDiff.toFixed(1)}Â°`);
            
            // é€‰æ‹©æœ€çŸ­è·¯å¾„æ—‹è½¬ï¼ˆå¤„ç†è§’åº¦è·¨è¶Š360åº¦çš„æƒ…å†µï¼‰
            while (yAngleDiff > 180) yAngleDiff -= 360;
            while (yAngleDiff < -180) yAngleDiff += 360;
            
            // åº”ç”¨æ—‹è½¬
            sceneRotation.y += yAngleDiff;
            sceneRotation.x += xAngleDiff;
            
            // æ·»åŠ æ—‹è½¬åŠ¨ç”»æ•ˆæœ
            sceneVelocity.y = yAngleDiff * 0.3;
            sceneVelocity.x = xAngleDiff * 0.3;
            
            // ç«‹å³æ›´æ–°ç¼©ç•¥å›¾çŠ¶æ€
            updateThumbnailStates();
            
            console.log(`æ—‹è½¬åˆ°å¡ç‰‡ ${targetIndex}: è§’åº¦ ${targetTheta.toFixed(2)}, Yæ—‹è½¬ ${targetYRotation.toFixed(1)}Â°`);
            console.log(`æ—‹è½¬ååœºæ™¯: Y=${sceneRotation.y.toFixed(1)}Â°, X=${sceneRotation.x.toFixed(1)}Â°`);
            
            // å®Œæˆæ£€æµ‹
            setTimeout(() => {
                if (isRotating && rotationTargetIndex === targetIndex) {
                    isRotating = false;
                    rotationTargetIndex = -1;
                    updateNavigationState();
                    console.log(`æ—‹è½¬å®Œæˆåˆ°å¡ç‰‡ ${targetIndex}`);
                }
            }, 1200);
        }

        function navigatePrevious() {
            console.log('å¯¼èˆªï¼šä¸Šä¸€å¼ å¡ç‰‡');
            const prevIndex = (currentCenterIndex - 1 + windows.length) % windows.length;
            console.log(`ä» ${currentCenterIndex} å¯¼èˆªåˆ°ä¸Šä¸€å¼  ${prevIndex}`);
            centerCardToEquator(prevIndex);
        }

        function navigateNext() {
            console.log('å¯¼èˆªï¼šä¸‹ä¸€å¼ å¡ç‰‡');
            const nextIndex = (currentCenterIndex + 1) % windows.length;
            console.log(`ä» ${currentCenterIndex} å¯¼èˆªåˆ°ä¸‹ä¸€å¼  ${nextIndex}`);
            centerCardToEquator(nextIndex);
        }

        // å¿«é€Ÿæ—‹è½¬ç‰ˆæœ¬ï¼Œä¸“ä¸ºé”®ç›˜å’Œç®­å¤´å¯¼èˆªä¼˜åŒ–
        function rotateToCardFast(targetIndex) {
            console.log(`å¿«é€Ÿæ—‹è½¬åˆ°å¡ç‰‡ ${targetIndex}, å½“å‰ä¸­å¿ƒ: ${currentCenterIndex}`);
            
            if (targetIndex < 0 || targetIndex >= windows.length) {
                console.log('æ— æ•ˆçš„ç›®æ ‡ç´¢å¼•');
                return;
            }
            
            // ç«‹å³æ›´æ–°ä¸­å¿ƒç´¢å¼•
            currentCenterIndex = targetIndex;
            
            // å¼ºåˆ¶é‡ç½®æ—‹è½¬çŠ¶æ€
            isRotating = false;
            rotationTargetIndex = -1;
            
            // è®¾ç½®æ–°çš„æ—‹è½¬çŠ¶æ€
            isRotating = true;
            rotationTargetIndex = targetIndex;
            rotationStartTime = Date.now();
            updateNavigationState();
            
            // ä½¿ç”¨ä¸å¸ƒå±€ç›¸åŒçš„è§’åº¦è®¡ç®—ï¼Œç¡®ä¿å‡†ç¡®å±…ä¸­
            const baseAngleStep = (2 * Math.PI) / contentTemplates.length;
            const goldenOffset = Math.PI * (3 - Math.sqrt(5)) * 0.3;
            const targetTheta = targetIndex * baseAngleStep + targetIndex * goldenOffset;
            
            // è®¡ç®—ç›®æ ‡å¡ç‰‡çš„Yä½ç½®
            const targetY = 1 - (targetIndex / (contentTemplates.length - 1)) * 2;
            
            // è®¡ç®—ç›®æ ‡æ—‹è½¬è§’åº¦
            const targetYRotation = -targetTheta * (180 / Math.PI);
            const targetXRotation = -Math.asin(targetY) * (180 / Math.PI) * 1.0; // å¢åŠ Xè½´æ—‹è½¬å¹…åº¦
            

            
            // è®¡ç®—æœ€çŸ­è·¯å¾„çš„è§’åº¦å·®
            let yAngleDiff = targetYRotation - sceneRotation.y;
            let xAngleDiff = targetXRotation - sceneRotation.x;
            
            // é€‰æ‹©æœ€çŸ­è·¯å¾„æ—‹è½¬
            while (yAngleDiff > 180) yAngleDiff -= 360;
            while (yAngleDiff < -180) yAngleDiff += 360;
            
            // åº”ç”¨æ—‹è½¬ï¼ˆæ›´å¿«çš„åŠ¨ç”»é€Ÿåº¦ï¼‰
            sceneRotation.y += yAngleDiff;
            sceneRotation.x += xAngleDiff;
            sceneVelocity.y = yAngleDiff * 0.5; // æ¯”æ™®é€šæ—‹è½¬æ›´å¿«
            sceneVelocity.x = xAngleDiff * 0.5;
            
            // ç«‹å³æ›´æ–°ç¼©ç•¥å›¾çŠ¶æ€
            updateThumbnailStates();
            
            console.log(`å¿«é€Ÿæ—‹è½¬åˆ°å¡ç‰‡ ${targetIndex}: è§’åº¦ ${targetTheta.toFixed(2)}, Yæ—‹è½¬ ${targetYRotation.toFixed(1)}Â°`);
            
            // æ›´çŸ­çš„å®Œæˆæ£€æµ‹æ—¶é—´
            setTimeout(() => {
                if (isRotating && rotationTargetIndex === targetIndex) {
                    isRotating = false;
                    rotationTargetIndex = -1;
                    updateNavigationState();
                    console.log(`å¿«é€Ÿæ—‹è½¬å®Œæˆåˆ°å¡ç‰‡ ${targetIndex}`);
                }
            }, 600); // å‡å°‘åˆ°600ms
        }

        function updateNavigationState() {
            const prevArrow = document.getElementById('prevArrow');
            const nextArrow = document.getElementById('nextArrow');
            
            if (isRotating) {
                prevArrow.classList.add('rotating');
                nextArrow.classList.add('rotating');
            } else {
                prevArrow.classList.remove('rotating');
                nextArrow.classList.remove('rotating');
            }
        }

        function checkRotationComplete() {
            if (!isRotating || rotationTargetIndex === -1) return;
            
            // æ£€æŸ¥åœºæ™¯æ—‹è½¬é€Ÿåº¦æ˜¯å¦è¶³å¤Ÿå°ï¼ˆæ¥è¿‘é™æ­¢ï¼‰
            const velocityThreshold = 0.5;
            const isNearlyStill = Math.abs(sceneVelocity.y) < velocityThreshold;
            
            // æ£€æŸ¥æ˜¯å¦å·²ç»æ¥è¿‘ç›®æ ‡ä½ç½®
            const isAtTarget = currentCenterIndex === rotationTargetIndex;
            
            if (isNearlyStill && isAtTarget) {
                // æ—‹è½¬å®Œæˆ
                isRotating = false;
                rotationTargetIndex = -1;
                updateNavigationState();
                updateThumbnailStates();
                console.log(`æ—‹è½¬å®Œæˆï¼Œå½“å‰ä¸­å¿ƒå¡ç‰‡: ${currentCenterIndex}`);
            }
            
            // å¢åŠ è¶…æ—¶æœºåˆ¶ï¼Œé˜²æ­¢å¡ä½
            if (isRotating && Date.now() - rotationStartTime > 3000) {
                console.log('æ—‹è½¬è¶…æ—¶ï¼Œå¼ºåˆ¶å®Œæˆ');
                if (rotationTargetIndex !== -1) {
                    currentCenterIndex = rotationTargetIndex; // æ›´æ–°åˆ°ç›®æ ‡ç´¢å¼•
                }
                isRotating = false;
                rotationTargetIndex = -1;
                updateNavigationState();
                updateThumbnailStates();
            }
        }

        function updateThumbnailStates() {
            // æ›´æ–°ç¼©ç•¥å›¾çŠ¶æ€
            thumbnails.forEach((thumbnail, index) => {
                if (index === currentCenterIndex) {
                    thumbnail.el.classList.add('active');
                } else {
                    thumbnail.el.classList.remove('active');
                }
            });
            
            // æ›´æ–°ä¸»ç•Œé¢å¡ç‰‡çš„ä¸­å¿ƒé«˜äº®æ•ˆæœ
            windows.forEach((win, index) => {
                if (index === currentCenterIndex) {
                    win.el.classList.add('center-highlight');
                } else {
                    win.el.classList.remove('center-highlight');
                }
            });
            
            // åŒæ­¥æ›´æ–°å¯¼èˆªçƒçŠ¶æ€
            updateNavGlobeStates();
        }

        function findCenterCard() {
            // åŸºäºåå­—å‡†æ˜Ÿä½ç½®ï¼ˆå±å¹•ä¸­å¿ƒï¼‰è¿›è¡Œå¡ç‰‡ä¸­å¿ƒæ£€æµ‹
            let closestIndex = 0;
            let minDistance = Infinity;
            
            windows.forEach((win, index) => {
                // è·å–å¡ç‰‡ç»è¿‡åœºæ™¯æ—‹è½¬åçš„å®é™…3Dåæ ‡
                const originalPos = calculateOriginalPosition(index);
                const rotatedPos = rotatePoint(originalPos, sceneRotation);
                
                // è®¡ç®—å¡ç‰‡åœ¨å±å¹•æŠ•å½±ä¸åå­—å‡†æ˜Ÿçš„è·ç¦»
                // åå­—å‡†æ˜Ÿä½äºå±å¹•ä¸­å¿ƒ (0, 0)ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸»è¦å…³æ³¨Xå’ŒYçš„è·ç¦»
                const distance = Math.sqrt(rotatedPos.x * rotatedPos.x + rotatedPos.y * rotatedPos.y);
                
                // æ·»åŠ Zè½´æƒé‡ï¼Œè¶Šé è¿‘è§‚å¯Ÿè€…çš„å¡ç‰‡ä¼˜å…ˆçº§è¶Šé«˜
                const weightedDistance = distance - (rotatedPos.z * 0.001);
                
                if (weightedDistance < minDistance) {
                    minDistance = weightedDistance;
                    closestIndex = index;
                }
            });
            
            if (closestIndex !== currentCenterIndex) {
                currentCenterIndex = closestIndex;
                updateThumbnailStates();
                
                // æ·»åŠ è°ƒè¯•ä¿¡æ¯
                console.log(`Center card changed to index: ${closestIndex}, title: ${contentTemplates[closestIndex].title}`);
                console.log(`Distance to crosshair: ${minDistance.toFixed(3)}`);
            }
        }

        // æ–°å¢ï¼šçƒä½“èµ¤é“è§†è§’å±…ä¸­å‡½æ•°
        function centerCardToEquator(targetIndex) {
            console.log(`å°†å¡ç‰‡ ${targetIndex} å±…ä¸­å¹¶è°ƒæ•´åˆ°èµ¤é“è§†è§’`);
            
            if (targetIndex < 0 || targetIndex >= windows.length) {
                console.log('æ— æ•ˆçš„ç›®æ ‡ç´¢å¼•');
                return;
            }
            
            // è®¡ç®—éœ€è¦çš„Yè½´æ—‹è½¬è§’åº¦ï¼Œä½¿è¯¥å¡ç‰‡ä½äºå±å¹•ä¸­å¿ƒ
            const baseAngleStep = (2 * Math.PI) / contentTemplates.length;
            const goldenOffset = Math.PI * (3 - Math.sqrt(5)) * 0.3;
            const targetTheta = targetIndex * baseAngleStep + targetIndex * goldenOffset;
            
            // ç›®æ ‡Yè½´æ—‹è½¬è§’åº¦
            const targetYRotation = (targetTheta * (180 / Math.PI)) + 90;
            
            // ç›®æ ‡Xè½´æ—‹è½¬è§’åº¦è®¾ä¸º0ï¼Œä¿æŒèµ¤é“è§†è§’
            const targetXRotation = 0;
            
            // è®¡ç®—è§’åº¦å·®
            const yDiff = targetYRotation - sceneRotation.y;
            const xDiff = targetXRotation - sceneRotation.x;
            
            // å¤„ç†Yè½´è§’åº¦è·¨è¶Šé—®é¢˜
            let normalizedYDiff = yDiff;
            while (normalizedYDiff > 180) normalizedYDiff -= 360;
            while (normalizedYDiff < -180) normalizedYDiff += 360;
            
            // åº”ç”¨æ—‹è½¬
            sceneRotation.y += normalizedYDiff;
            sceneRotation.x = targetXRotation; // ç›´æ¥å°†Xè½´æ—‹è½¬è®¾ç½®ä¸ºç›®æ ‡å€¼ (0)
            
            // è®¾ç½®å¹³æ»‘åŠ¨ç”»
            sceneVelocity.y = normalizedYDiff * 0.3;
            sceneVelocity.x = 0; // å°†Xè½´é€Ÿåº¦è®¾ç½®ä¸º0ï¼Œé˜²æ­¢åç»­æ™ƒåŠ¨
            
            // æ›´æ–°å½“å‰ä¸­å¿ƒç´¢å¼•
            currentCenterIndex = targetIndex;
            updateThumbnailStates();
            
            console.log(`å¡ç‰‡ ${targetIndex} å·²å±…ä¸­åˆ°èµ¤é“è§†è§’ï¼ŒYè½´æ—‹è½¬: ${targetYRotation.toFixed(1)}Â°ï¼ŒXè½´é‡ç½®ä¸º0Â°`);
        }

        let isOutlinePanelOpen = false; // æ–°å¢çŠ¶æ€å˜é‡

        function toggleOutlinePanel() {
            const thumbnailContainer = document.getElementById('thumbnailContainer');
            const prevArrow = document.getElementById('prevArrow');
            const nextArrow = document.getElementById('nextArrow');
            const outlinePanel = document.getElementById('outlinePanel');
            const outlineToggle = document.getElementById('outlineToggle');

            if (isOutlinePanelOpen) {
                // å…³é—­å¤§çº²é¢æ¿
                outlinePanel.classList.remove('active');
                
                // å»¶è¿Ÿæ˜¾ç¤ºç¼©ç•¥å›¾ï¼Œè®©å¤§çº²é¢æ¿å…ˆæ”¶ç¼©
                setTimeout(() => {
                    showThumbnailsWithAnimation();
                    prevArrow.style.opacity = '1';
                    prevArrow.style.pointerEvents = 'auto';
                    nextArrow.style.opacity = '1';
                    nextArrow.style.pointerEvents = 'auto';
                    thumbnailContainer.style.pointerEvents = 'auto';
                }, 200);

            } else {
                // éšè—ç¼©ç•¥å›¾
                hideThumbnailsWithAnimation();
                
                // å»¶è¿Ÿæ˜¾ç¤ºå¤§çº²é¢æ¿
                setTimeout(() => {
                    populateOutline();
                    const toggleRect = outlineToggle.getBoundingClientRect();
                    outlinePanel.style.left = `${toggleRect.left}px`;
                    outlinePanel.style.bottom = `${window.innerHeight - toggleRect.top}px`;
                    outlinePanel.classList.add('active');
                }, 300);
                
                prevArrow.style.opacity = '0';
                prevArrow.style.pointerEvents = 'none';
                nextArrow.style.opacity = '0';
                nextArrow.style.pointerEvents = 'none';
                thumbnailContainer.style.pointerEvents = 'none';
            }
            isOutlinePanelOpen = !isOutlinePanelOpen;
        }

        function hideThumbnailsWithAnimation() {
            const thumbnailCards = document.querySelectorAll('.thumbnail-card');
            thumbnailCards.forEach((card, index) => {
                setTimeout(() => {
                    card.classList.add('slide-out');
                }, index * 50); // æ¯ä¸ªå¡ç‰‡å»¶è¿Ÿ50ms
            });
        }

        function showThumbnailsWithAnimation() {
            const thumbnailCards = document.querySelectorAll('.thumbnail-card');
            
            // é¦–å…ˆç§»é™¤æ‰€æœ‰åŠ¨ç”»ç±»å¹¶é‡ç½®çŠ¶æ€
            thumbnailCards.forEach(card => {
                card.classList.remove('slide-out', 'slide-in');
                card.style.opacity = '0';
                card.style.transform = 'translateX(-60px) scale(0.8)';
            });
            
            // é€ä¸ªæ˜¾ç¤ºç¼©ç•¥å›¾
            thumbnailCards.forEach((card, index) => {
                setTimeout(() => {
                    card.classList.add('slide-in');
                    card.style.opacity = '';
                    card.style.transform = '';
                }, index * 80); // æ¯ä¸ªå¡ç‰‡å»¶è¿Ÿ80msï¼Œæ›´æ…¢æ›´ä¼˜é›…
            });
            
            // æ¸…ç†åŠ¨ç”»ç±»
            setTimeout(() => {
                thumbnailCards.forEach(card => {
                    card.classList.remove('slide-in');
                });
            }, thumbnailCards.length * 80 + 500);
        }

        function populateOutline() {
            const outlineList = document.getElementById('outlineList');
            outlineList.innerHTML = ''; // æ¸…ç©ºç°æœ‰åˆ—è¡¨

            contentTemplates.forEach((template, index) => {
                const listItem = document.createElement('li');
                listItem.className = 'outline-list-item';
                listItem.textContent = template.title;
                listItem.dataset.index = index; // å­˜å‚¨å¡ç‰‡ç´¢å¼•

                listItem.addEventListener('click', () => {
                    centerCardToEquator(index); // å¯¼èˆªåˆ°å¯¹åº”å¡ç‰‡
                    toggleOutlinePanel(); // å…³é—­å¤§çº²é¢æ¿
                });
                outlineList.appendChild(listItem);
            });
        }

        function recalculateLayout() {
            // Function remains unchanged
            windows.forEach((win, i) => {
                const newPos = calculateOriginalPosition(i);
                win.originalX = newPos.x;
                win.originalY = newPos.y;
                win.originalZ = newPos.z;
            });
        }
        
        // æš‚æ—¶æ³¨é‡Šæ‰å¾„å‘èœå•æ˜¾ç¤ºéšè—å‡½æ•° - 2024å¹´æ›´æ–°
        /*
        function showRadialMenu(winState, event) { if (!winState || !winState.radialMenu) return; const rect = winState.el.getBoundingClientRect(); const x = event.clientX - rect.left; const y = event.clientY - rect.top; const menu = winState.radialMenu; menu.style.left = `${x}px`; menu.style.top = `${y}px`; menu.style.transform = `translate(-50%, -50%)`; menu.classList.add('active'); activeMenuWindow = winState; }
        function hideRadialMenu() { if (!activeMenuWindow || !activeMenuWindow.radialMenu) return; activeMenuWindow.radialMenu.classList.remove('active'); activeMenuWindow = null; }
        */
        function onMarkerClick(e) { if (!e.target.classList.contains('marker-dot')) return; e.stopPropagation(); const marker = e.target; const color = marker.dataset.color; const windowEl = marker.closest('.fui-window'); const winState = windows.find(w => w.el === windowEl); if (!color || !winState) return; const highlightClass = `highlight-${color}`; const isAlreadyHighlighted = windowEl.classList.contains(highlightClass); windowEl.classList.remove('highlight-pink', 'highlight-blue', 'highlight-yellow'); winState.highlightColor = null; if (!isAlreadyHighlighted) { windowEl.classList.add(highlightClass); winState.highlightColor = color; } }
        // =================================================================
        // ğŸ® EVENT HANDLERS - äº‹ä»¶å¤„ç†å‡½æ•°
        // =================================================================
        // è¯´æ˜ï¼šè¿™äº›å‡½æ•°å¤„ç†ç”¨æˆ·äº¤äº’äº‹ä»¶ï¼ˆé¼ æ ‡ã€é”®ç›˜ã€è§¦æ‘¸ç­‰ï¼‰
        // âŒ ä¸å»ºè®®ä¿®æ”¹ï¼šè¿™äº›æ˜¯äº¤äº’é€»è¾‘çš„æ ¸å¿ƒï¼Œä¿®æ”¹å¯èƒ½å½±å“ç”¨æˆ·ä½“éªŒ
        // =================================================================
        
        function onMouseDown(e) { 
            if (e.target.closest('.controls-panel') || 
                // e.target.closest('.radial-menu-item') ||   // æš‚æ—¶æ³¨é‡Šæ‰å¾„å‘èœå•æ£€æµ‹ - 2024å¹´æ›´æ–°
                e.target.classList.contains('marker-dot')) return; 
            
            // æš‚æ—¶æ³¨é‡Šæ‰å¾„å‘èœå•éšè—é€»è¾‘ - 2024å¹´æ›´æ–°
            // if(activeMenuWindow){ hideRadialMenu(); return; } 
            
            const targetWindowEl = e.target.closest('.fui-window'); 
            lastMouse.x = e.clientX; 
            lastMouse.y = e.clientY; 
            startDragPos = { x: e.clientX, y: e.clientY }; 
            
            if (e.target.classList.contains('resize-handle') && targetWindowEl) { 
                isResizing = true; 
                resizingWindow = windows.find(w => w.id === targetWindowEl.id); 
                document.body.style.cursor = 'se-resize'; 
            } else if (targetWindowEl) { 
                // æš‚æ—¶æ³¨é‡Šæ‰é•¿æŒ‰æ£€æµ‹å’Œå¾„å‘èœå•é€»è¾‘ï¼Œæ”¹ä¸ºç›´æ¥å¯åŠ¨åœºæ™¯æ—‹è½¬ - 2024å¹´æ›´æ–°
                // å…è®¸åœ¨å¡ç‰‡ä¸Šä¹Ÿèƒ½æ‹–æ‹½æ—‹è½¬ç•Œé¢
                isRotatingScene = true; 
                document.body.style.cursor = 'grabbing'; 
                sceneVelocity.x = sceneVelocity.y = 0; 
            } else { 
                isRotatingScene = true; 
                document.body.style.cursor = 'grabbing'; 
                sceneVelocity.x = sceneVelocity.y = 0; 
            } 
        }
        function onMouseMove(e) { 
            const dx = e.clientX - lastMouse.x; 
            const dy = e.clientY - lastMouse.y; 
            const moveDist = Math.hypot(e.clientX - startDragPos.x, e.clientY - startDragPos.y); 
            
            // æš‚æ—¶æ³¨é‡Šæ‰é•¿æŒ‰æ£€æµ‹é€»è¾‘ - 2024å¹´æ›´æ–°
            // if (longPressTimer && moveDist > 5) { 
            //     clearTimeout(longPressTimer); 
            //     longPressTimer = null; 
            //     isRotatingScene = true; 
            //     document.body.style.cursor = 'grabbing'; 
            // } 
            
            if (isResizing && resizingWindow) { 
                resizingWindow.width += dx; 
                resizingWindow.height += dy; 
            } else if (isRotatingScene) { 
                sceneRotation.y += dx * rotationFactor; 
                sceneRotation.x -= dy * rotationFactor; 
                sceneVelocity.y = dx * rotationFactor; 
                sceneVelocity.x = -dy * rotationFactor; 
            } 
            lastMouse.x = e.clientX; 
            lastMouse.y = e.clientY; 
        }
        function onMouseUp(e) { 
            // æš‚æ—¶æ³¨é‡Šæ‰é•¿æŒ‰æ£€æµ‹æ¸…é™¤é€»è¾‘ - 2024å¹´æ›´æ–°
            // clearTimeout(longPressTimer); 
            // longPressTimer = null;
            
            if (isRotatingScene || isResizing) { 
                isRotatingScene = false; 
                isResizing = false; 
                resizingWindow = null; 
                document.body.style.cursor = 'grab'; 
                console.log('é¼ æ ‡æ¾å¼€ï¼Œé‡ç½®æ—‹è½¬çŠ¶æ€');
            } 
        }
        // é”®ç›˜å¯¼èˆªé˜²æŠ–
        let lastKeyPressTime = 0;
        const keyPressThreshold = 200; // æ¯«ç§’

        function onKeyDown(e) { 
            const rotationVelocityStep = 2; 
            const currentTime = Date.now();
            
            // å¦‚æœæœ‰èšç„¦çš„çª—å£ï¼Œæ–¹å‘é”®æ§åˆ¶å…¶å†…å®¹æ»šåŠ¨
            if (focusedWindow) {
                const contentEl = focusedWindow.el.querySelector('.fui-content');
                if (contentEl && (e.key === 'ArrowUp' || e.key === 'ArrowDown')) {
                    const scrollAmount = e.key === 'ArrowUp' ? -50 : 50;
                    contentEl.scrollTop += scrollAmount;
                    return;
                }
            }
            
            // å¡ç‰‡å¯¼èˆªæ§åˆ¶ï¼ˆä¼˜åŒ–å“åº”æ€§ï¼‰
            if (e.key === 'ArrowLeft') {
                e.preventDefault();
                console.log('é”®ç›˜ï¼šå·¦ç®­å¤´é”®æŒ‰ä¸‹');
                
                // é˜²æŠ–å¤„ç†ï¼Œä½†å…è®¸æ›´é¢‘ç¹çš„æ“ä½œ
                if (currentTime - lastKeyPressTime > keyPressThreshold) {
                    lastKeyPressTime = currentTime;
                    // å¦‚æœæ­£åœ¨æ—‹è½¬ï¼Œå¼ºåˆ¶å®Œæˆå½“å‰æ—‹è½¬
                    if (isRotating) {
                        isRotating = false;
                        rotationTargetIndex = -1;
                        updateNavigationState();
                        console.log('å¼ºåˆ¶å®Œæˆå½“å‰æ—‹è½¬ï¼Œç«‹å³å“åº”é”®ç›˜');
                    }
                    navigatePrevious();
                } else {
                    console.log('é”®ç›˜æ“ä½œè¿‡å¿«ï¼Œè·³è¿‡');
                }
                return;
            } else if (e.key === 'ArrowRight') {
                e.preventDefault();
                console.log('é”®ç›˜ï¼šå³ç®­å¤´é”®æŒ‰ä¸‹');
                
                // é˜²æŠ–å¤„ç†ï¼Œä½†å…è®¸æ›´é¢‘ç¹çš„æ“ä½œ
                if (currentTime - lastKeyPressTime > keyPressThreshold) {
                    lastKeyPressTime = currentTime;
                    // å¦‚æœæ­£åœ¨æ—‹è½¬ï¼Œå¼ºåˆ¶å®Œæˆå½“å‰æ—‹è½¬
                    if (isRotating) {
                        isRotating = false;
                        rotationTargetIndex = -1;
                        updateNavigationState();
                        console.log('å¼ºåˆ¶å®Œæˆå½“å‰æ—‹è½¬ï¼Œç«‹å³å“åº”é”®ç›˜');
                    }
                    navigateNext();
                } else {
                    console.log('é”®ç›˜æ“ä½œè¿‡å¿«ï¼Œè·³è¿‡');
                }
                return;
            }
            
            // åœºæ™¯æ—‹è½¬æ§åˆ¶ï¼ˆä»…ä¸Šä¸‹é”®ï¼‰
            if (e.key === 'ArrowUp') sceneVelocity.x += rotationVelocityStep; 
            else if (e.key === 'ArrowDown') sceneVelocity.x -= rotationVelocityStep; 
        }
        function onDoubleClick(e) { 
            if (e.target.closest('.controls-panel') || 
                // e.target.closest('.radial-menu-item') ||   // æš‚æ—¶æ³¨é‡Šæ‰å¾„å‘èœå•æ£€æµ‹ - 2024å¹´æ›´æ–°
                e.target.classList.contains('marker-dot')) return; 
            
            // æš‚æ—¶æ³¨é‡Šæ‰å¾„å‘èœå•æ£€æŸ¥ - 2024å¹´æ›´æ–°
            // if (activeMenuWindow) return; 
            
            // ç¡®ä¿åŒå‡»æ—¶æ¸…ç†æ‰€æœ‰çŠ¶æ€
            e.preventDefault();
            e.stopPropagation();
            // æš‚æ—¶æ³¨é‡Šæ‰é•¿æŒ‰æ£€æµ‹æ¸…é™¤ - 2024å¹´æ›´æ–°
            // clearTimeout(longPressTimer);
            // longPressTimer = null;
            isRotatingScene = false;
            isResizing = false;
            document.body.style.cursor = 'grab';
            
            const clickedWindowEl = e.target.closest('.fui-window'); 
            if (clickedWindowEl && !e.target.classList.contains('resize-handle')) { 
                toggleFocus(windows.find(w => w.id === clickedWindowEl.id)); 
            } else if (!clickedWindowEl && focusedWindow) { 
                toggleFocus(focusedWindow); 
            } 
        }
        function toggleFocus(win) { 
            if (!win) return; 
            
            // é‡ç½®æ‰€æœ‰é¼ æ ‡å’Œæ—‹è½¬çŠ¶æ€
            sceneVelocity.x = sceneVelocity.y = 0; 
            isRotatingScene = false;
            isResizing = false;
            resizingWindow = null;
            document.body.style.cursor = 'grab';
            
            const isAlreadyFocused = focusedWindow === win; 
            
            if (focusedWindow) { 
                const winToUnfocus = focusedWindow; 
                winToUnfocus.el.classList.remove('focused'); 
                winToUnfocus.targetScale = 1.0; 
                winToUnfocus.isFocusing = true; 
            } 
            
            if (!isAlreadyFocused) { 
                focusedWindow = win; 
                win.el.classList.add('focused'); 
                win.targetScale = 1.3; 
                win.targetX = 0; 
                win.targetY = 0; 
                win.targetZ = 1000; 
                win.isFocusing = true; 
            } else { 
                focusedWindow = null; 
            }
            
            console.log(`åˆ‡æ¢èšç„¦çŠ¶æ€: ${isAlreadyFocused ? 'å–æ¶ˆèšç„¦' : 'èšç„¦'}, isRotatingScene: ${isRotatingScene}`);
        }
        function onWheel(e) { 
            e.preventDefault(); 
            
            // å¦‚æœå¤§çº²é¢æ¿æ‰“å¼€ï¼Œæ»šåŠ¨å¤§çº²å†…å®¹
            if (isOutlinePanelOpen) {
                const outlineList = document.getElementById('outlineList');
                if (outlineList) {
                    outlineList.scrollTop += e.deltaY * 0.5;
                    return; // é˜»æ­¢åœºæ™¯æ—‹è½¬
                }
            }

            // å¦‚æœæœ‰èšç„¦çš„çª—å£ï¼Œä¼˜å…ˆæ§åˆ¶å…¶å†…å®¹æ»šåŠ¨
            if (focusedWindow) {
                const contentEl = focusedWindow.el.querySelector('.fui-content');
                if (contentEl) {
                    // æ§åˆ¶èšç„¦çª—å£çš„å†…å®¹æ»šåŠ¨
                    const scrollAmount = e.deltaY * 0.5;
                    contentEl.scrollTop += scrollAmount;
                    return; // ä¸æ‰§è¡Œåœºæ™¯æ—‹è½¬
                }
            }
            
            // äº¤æ¢æ»šè½®æ§åˆ¶ï¼šä¸Šä¸‹æ»šè½®æ§åˆ¶å·¦å³æ—‹è½¬ï¼Œå·¦å³æ»šè½®æ§åˆ¶ä¸Šä¸‹æ—‹è½¬
            const wheelRotationFactor = 0.2; 
            sceneVelocity.y += e.deltaY * wheelRotationFactor;  // ä¸Šä¸‹æ»šè½®æ§åˆ¶å·¦å³æ—‹è½¬
            sceneVelocity.x -= e.deltaX * wheelRotationFactor;  // å·¦å³æ»šè½®æ§åˆ¶ä¸Šä¸‹æ—‹è½¬
        }
        
        // Other functions (updateWindowTransform, rotatePoint) remain unchanged
        function updateWindowTransform(winState) { const { el, x, y, z, scale, width, height } = winState; el.style.width = `${width}px`; el.style.height = `${height}px`; const contentEl = el.querySelector('.fui-content'); if (contentEl) contentEl.style.maxHeight = `${height - 60}px`; el.style.transform = `translateX(${-width/2}px) translateY(${-height/2}px) translate3d(${x}px, ${y}px, ${z}px) scale(${scale})`;}
        function rotatePoint(point, rotation) { const radX = rotation.x * (Math.PI / 180), radY = rotation.y * (Math.PI / 180); const sinX = Math.sin(radX), cosX = Math.cos(radX); const sinY = Math.sin(radY), cosY = Math.cos(radY); const { x, y, z } = point; const x1 = x * cosY + z * sinY; const z1 = -x * sinY + z * cosY; const y2 = y * cosX - z1 * sinX; const z2 = y * sinX + z1 * cosX; return { x: x1, y: y2, z: z2 };}



        // =================================================================
        // ğŸ¬ ANIMATION & RENDER LOOP - åŠ¨ç”»å’Œæ¸²æŸ“å¾ªç¯
        // =================================================================
        // è¯´æ˜ï¼šè¿™äº›å‡½æ•°è´Ÿè´£åŠ¨ç”»æ›´æ–°å’Œæ¸²æŸ“é€»è¾‘
        // âŒ ä¸å»ºè®®ä¿®æ”¹ï¼šè¿™æ˜¯æ€§èƒ½å…³é”®çš„æ¸²æŸ“é€»è¾‘
        // =================================================================
        
        function animationLoop() {
            // æš‚æ—¶æ³¨é‡Šæ‰å¾„å‘èœå•å’Œé•¿æŒ‰æ£€æµ‹çŠ¶æ€ - 2024å¹´æ›´æ–°
            if (!isRotatingScene /* && !longPressTimer && !activeMenuWindow */) {
                sceneRotation.x += sceneVelocity.x;
                sceneRotation.y += sceneVelocity.y;
                sceneVelocity.x *= damping;
                sceneVelocity.y *= damping;
            }
            sceneRotation.x = Math.max(-85, Math.min(85, sceneRotation.x));
            sceneScale += (targetScale - sceneScale) * 0.1;
            origin.style.transform = `scale(${sceneScale})`;
            
            // æ›´æ–°å¯¼èˆªçƒçš„æ—‹è½¬
            updateNavGlobeRotation();
            
            windows.forEach(win => {
                const isUrgent = win.isFocusing;
                const currentSpringFactor = isUrgent ? focusSpringFactor : springFactor;
                const currentSpringDamping = isUrgent ? focusSpringDamping : springDamping;
                const currentScaleSpeed = isUrgent ? focusScaleSpeed : 0.1;

                if (win !== focusedWindow) {
                    const rotatedPos = rotatePoint({x: win.originalX, y: win.originalY, z: win.originalZ}, sceneRotation);
                    win.targetX = rotatedPos.x;
                    win.targetY = rotatedPos.y;
                    win.targetZ = focusedWindow ? rotatedPos.z - 2000 : rotatedPos.z;
                }
                
                if (isUrgent) {
                    const distSq = Math.hypot(win.targetX - win.x, win.targetY - win.y, win.targetZ - win.z);
                    if (distSq < 1) {
                        win.isFocusing = false;
                        win.x = win.targetX; win.y = win.targetY; win.z = win.targetZ;
                        win.scale = win.targetScale;
                        win.vx = win.vy = win.vz = 0;
                    }
                }

                win.vx = (win.vx + (win.targetX - win.x) * currentSpringFactor) * currentSpringDamping;
                win.vy = (win.vy + (win.targetY - win.y) * currentSpringFactor) * currentSpringDamping;
                win.vz = (win.vz + (win.targetZ - win.z) * currentSpringFactor) * currentSpringDamping;
                win.scale += (win.targetScale - win.scale) * currentScaleSpeed;

                win.x += win.vx; win.y += win.vy; win.z += win.vz;
                updateWindowTransform(win);
            });

            // æ£€æŸ¥æ—‹è½¬æ˜¯å¦å®Œæˆ
            checkRotationComplete();
            
            // æ³¨æ„ï¼šä¸ä½¿ç”¨è‡ªåŠ¨ä¸­å¿ƒæ£€æµ‹ï¼Œæ”¹ä¸ºæ‰‹åŠ¨è®¾ç½®é¿å…å†²çª

            requestAnimationFrame(animationLoop);
        }

        // =================================================================
        // ğŸ”„ CONTENT UPDATE FUNCTION - å†…å®¹æ›´æ–°å‡½æ•°
        // =================================================================
        // è¯´æ˜ï¼šè¿™ä¸ªå‡½æ•°è´Ÿè´£æ›´æ–°å¡ç‰‡å†…å®¹
        // âŒ ä¸å»ºè®®ä¿®æ”¹å‡½æ•°é€»è¾‘ï¼šè¿™æ˜¯å†…å®¹æ¸²æŸ“çš„æ ¸å¿ƒ
        // ğŸ“ å†…å®¹æ¥æºï¼šä» contentTemplates æ•°ç»„è·å–å†…å®¹
        // =================================================================
        
        function updateContent(winState) {
            const index = windows.findIndex(w => w.id === winState.id);
            if(index === -1) return;

            const template = contentTemplates[index % contentTemplates.length];
            const contentEl = winState.el.querySelector('.fui-content');
            if (template && contentEl) contentEl.innerHTML = template.content();
        }

        // =================================================================
        // ğŸ¨ JARVIS å³ä¸‹è§’æ•ˆæœç³»ç»Ÿ
        // =================================================================
        
        // ç²’å­èƒŒæ™¯ç½‘ç»œç³»ç»Ÿ
        function initParticleBackground() {
            const canvas = document.getElementById('particleCanvas');
            const ctx = canvas.getContext('2d');
            
            // è®¾ç½®canvaså°ºå¯¸
            function resizeCanvas() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);
            
            const particles = [];
            const particleCount = 100;
            const maxDistance = 150;
            let mouse = { x: null, y: null };
            
            // ç²’å­ç±»
            class Particle {
                constructor() {
                    this.x = Math.random() * canvas.width;
                    this.y = Math.random() * canvas.height;
                    this.size = Math.random() * 2 + 1;
                    this.speedX = (Math.random() - 0.5) * 0.5;
                    this.speedY = (Math.random() - 0.5) * 0.5;
                    this.opacity = Math.random() * 0.5 + 0.3;
                }
                
                update() {
                    this.x += this.speedX;
                    this.y += this.speedY;
                    
                    // è¾¹ç•Œæ£€æµ‹
                    if (this.x < 0 || this.x > canvas.width) this.speedX *= -1;
                    if (this.y < 0 || this.y > canvas.height) this.speedY *= -1;
                    
                    // é¼ æ ‡äº¤äº’
                    if (mouse.x !== null && mouse.y !== null) {
                        const dx = mouse.x - this.x;
                        const dy = mouse.y - this.y;
                        const distance = Math.sqrt(dx * dx + dy * dy);
                        
                        if (distance < 100) {
                            const force = (100 - distance) / 100;
                            this.x -= dx * force * 0.03;
                            this.y -= dy * force * 0.03;
                        }
                    }
                }
                
                draw() {
                    ctx.save();
                    ctx.globalAlpha = this.opacity;
                    ctx.fillStyle = '#87CEEB';
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.restore();
                }
            }
            
            // åˆ›å»ºç²’å­
            for (let i = 0; i < particleCount; i++) {
                particles.push(new Particle());
            }
            
            // ç»˜åˆ¶è¿æ¥çº¿
            function drawConnections() {
                for (let i = 0; i < particles.length; i++) {
                    for (let j = i + 1; j < particles.length; j++) {
                        const dx = particles[i].x - particles[j].x;
                        const dy = particles[i].y - particles[j].y;
                        const distance = Math.sqrt(dx * dx + dy * dy);
                        
                        if (distance < maxDistance) {
                            const opacity = (1 - distance / maxDistance) * 0.3;
                            ctx.save();
                            ctx.globalAlpha = opacity;
                            ctx.strokeStyle = '#87CEEB';
                            ctx.lineWidth = 0.5;
                            ctx.beginPath();
                            ctx.moveTo(particles[i].x, particles[i].y);
                            ctx.lineTo(particles[j].x, particles[j].y);
                            ctx.stroke();
                            ctx.restore();
                        }
                    }
                }
            }
            
            // åŠ¨ç”»å¾ªç¯
            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // æ›´æ–°å’Œç»˜åˆ¶ç²’å­
                particles.forEach(particle => {
                    particle.update();
                    particle.draw();
                });
                
                // ç»˜åˆ¶è¿æ¥çº¿
                drawConnections();
                
                requestAnimationFrame(animate);
            }
            
            // é¼ æ ‡äº‹ä»¶å¤„ç†
            canvas.addEventListener('mousemove', (e) => {
                mouse.x = e.clientX;
                mouse.y = e.clientY;
            });
            
            canvas.addEventListener('mouseleave', () => {
                mouse.x = null;
                mouse.y = null;
            });
            
            // å¯åŠ¨åŠ¨ç”»
            animate();
        }

        // 3Då…‰çƒåŠ¨ç”»ç³»ç»Ÿ
        function init3DSpheres() {
            const canvas = document.getElementById('cornerSphereCanvas');
            const ctx = canvas.getContext('2d');
            
            const spheres = [];
            const sphereCount = 6;
            
            // åˆ›å»ºçƒä½“
            for (let i = 0; i < sphereCount; i++) {
                spheres.push({
                    x: canvas.width / 2 + (Math.random() - 0.5) * 100,
                    y: canvas.height / 2 + (Math.random() - 0.5) * 60,
                    baseRadius: Math.random() * 15 + 10,
                    currentRadius: Math.random() * 15 + 10,
                    targetRadius: Math.random() * 15 + 10,
                    opacity: Math.random() * 0.6 + 0.2,
                    targetOpacity: Math.random() * 0.6 + 0.2,
                    color: Math.random() > 0.5 ? '#87CEEB' : '#FFD700',
                    phase: Math.random() * Math.PI * 2,
                    morphSpeed: Math.random() * 0.02 + 0.01,
                    pulsePhase: Math.random() * Math.PI * 2,
                    driftX: (Math.random() - 0.5) * 0.5,
                    driftY: (Math.random() - 0.5) * 0.3,
                    rotationSpeed: (Math.random() - 0.5) * 0.02
                });
            }
            
            function animateSpheres() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                spheres.forEach(sphere => {
                    // æ›´æ–°å½¢å˜
                    sphere.phase += sphere.morphSpeed;
                    sphere.pulsePhase += 0.03;
                    
                    // è®¡ç®—å½“å‰åŠå¾„ï¼ˆæœ‰æœºå˜å½¢ï¼‰
                    const morphFactor = Math.sin(sphere.phase) * 0.3 + Math.cos(sphere.phase * 1.7) * 0.2;
                    sphere.currentRadius = sphere.baseRadius * (1 + morphFactor);
                    
                    // é€æ˜åº¦å˜åŒ–ï¼ˆç¼“æ…¢æ·¡å…¥æ·¡å‡ºï¼‰
                    const pulseFactor = Math.sin(sphere.pulsePhase) * 0.3;
                    sphere.opacity = 0.4 + pulseFactor * 0.3;
                    
                    // ä½ç½®æ¼‚ç§»
                    sphere.x += sphere.driftX;
                    sphere.y += sphere.driftY;
                    
                    // è¾¹ç•Œåå¼¹
                    if (sphere.x < 20 || sphere.x > canvas.width - 20) sphere.driftX *= -1;
                    if (sphere.y < 15 || sphere.y > canvas.height - 15) sphere.driftY *= -1;
                    
                    // ç»˜åˆ¶çƒä½“ï¼ˆæ¤­åœ†å½¢çŠ¶ï¼‰
                    ctx.save();
                    ctx.translate(sphere.x, sphere.y);
                    ctx.scale(1, 0.7); // æ¤­åœ†å˜å½¢
                    
                    // åˆ›å»ºå¾„å‘æ¸å˜
                    const gradient = ctx.createRadialGradient(0, 0, 0, 0, 0, sphere.currentRadius);
                    gradient.addColorStop(0, `${sphere.color}${Math.round(sphere.opacity * 255).toString(16).padStart(2, '0')}`);
                    gradient.addColorStop(0.7, `${sphere.color}${Math.round(sphere.opacity * 100).toString(16).padStart(2, '0')}`);
                    gradient.addColorStop(1, `${sphere.color}00`);
                    
                    ctx.fillStyle = gradient;
                    ctx.beginPath();
                    ctx.arc(0, 0, sphere.currentRadius, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.restore();
                });
                
                requestAnimationFrame(animateSpheres);
            }
            
            animateSpheres();
        }

        // ç§‘æŠ€å›¾æ ‡åŠ¨ç”»ç³»ç»Ÿ
        function initCornerTechIcons() {
            const container = document.getElementById('cornerTechIcons');
            
            const techIcons = [
                'â—‰', 'â—', 'â¬¢', 'â¬¡', 'â—ˆ', 'â—‡', 'â¬Ÿ', 'â¬¢',
                'â—', 'â—‘', 'â—’', 'â—“'
            ];
            
            const iconElements = [];
            const iconCount = 12;
            const centerX = 90;
            const centerY = 90;
            const radius = 75;
            
            // åˆ›å»ºå›¾æ ‡å…ƒç´ 
            for (let i = 0; i < iconCount; i++) {
                const icon = document.createElement('div');
                icon.className = 'corner-tech-icon';
                icon.textContent = techIcons[i % techIcons.length];
                
                const angle = (i / iconCount) * Math.PI * 2 - Math.PI / 2;
                const x = centerX + Math.cos(angle) * radius;
                const y = centerY + Math.sin(angle) * radius;
                
                icon.style.left = x + 'px';
                icon.style.top = y + 'px';
                icon.style.transform = 'translate(-50%, -50%)';
                
                container.appendChild(icon);
                iconElements.push(icon);
            }
            
            function animateIconCycle() {
                // å±•å¼€åŠ¨ç”»
                iconElements.forEach((icon, index) => {
                    setTimeout(() => {
                        icon.classList.add('corner-animate-in');
                    }, index * 80);
                });
                
                // 2ç§’åå¼€å§‹æ¶ˆå¤±åŠ¨ç”»
                setTimeout(() => {
                    iconElements.forEach((icon, index) => {
                        setTimeout(() => {
                            icon.classList.remove('corner-animate-in');
                            icon.classList.add('corner-animate-out');
                        }, index * 60);
                    });
                    
                    // æ¶ˆå¤±åŠ¨ç”»å®Œæˆåé‡ç½®
                    setTimeout(() => {
                        iconElements.forEach(icon => {
                            icon.classList.remove('corner-animate-out');
                        });
                        
                        // 1ç§’åé‡æ–°å¼€å§‹
                        setTimeout(animateIconCycle, 1000);
                    }, iconCount * 60 + 400);
                }, 2000);
            }
            
            // å¼€å§‹åŠ¨ç”»å¾ªç¯
            setTimeout(animateIconCycle, 1000);
        }

        // =================================================================
        // ğŸš€ INITIALIZATION FUNCTION - åˆå§‹åŒ–å‡½æ•°
        // =================================================================
        // è¯´æ˜ï¼šç³»ç»Ÿå¯åŠ¨å’Œåˆå§‹åŒ–å‡½æ•°
        // âŒ ä¸å»ºè®®ä¿®æ”¹ï¼šè¿™æ˜¯æ ¸å¿ƒåˆå§‹åŒ–é€»è¾‘ï¼Œä¿®æ”¹å¯èƒ½å¯¼è‡´ç³»ç»Ÿæ— æ³•æ­£å¸¸å¯åŠ¨
        // =================================================================
        
        function init() {
            // åˆ›å»ºå¡ç‰‡çª—å£
            for (let i = 0; i < contentTemplates.length; i++) createWindow(i);
            
            // åˆ›å»ºå¯¼èˆªå…ƒç´ 
            createThumbnails();
            createNavGlobeDots();

            // ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
            document.addEventListener('mousedown', onMouseDown);
            document.addEventListener('mousemove', onMouseMove);
            document.addEventListener('mouseup', onMouseUp);
            document.addEventListener('dblclick', onDoubleClick);
            document.addEventListener('wheel', onWheel, { passive: false });
            document.addEventListener('keydown', onKeyDown);
            document.addEventListener('click', onMarkerClick);

            // å¯¼èˆªç®­å¤´äº‹ä»¶ç›‘å¬å™¨
            document.getElementById('prevArrow').addEventListener('click', navigatePrevious);
            document.getElementById('nextArrow').addEventListener('click', navigateNext);

            // æ§åˆ¶é¢æ¿åˆ‡æ¢åŠŸèƒ½
            const controlsPanel = document.getElementById('controls');
            const controlsToggle = document.getElementById('controlsToggle');
            controlsToggle.addEventListener('click', (e) => {
                e.stopPropagation();
                controlsPanel.classList.toggle('collapsed');
                console.log('æ§åˆ¶é¢æ¿åˆ‡æ¢çŠ¶æ€:', controlsPanel.classList.contains('collapsed') ? 'æ”¶ç¼©' : 'å±•å¼€');
            });

            // ç‚¹å‡»é¢æ¿å¤–éƒ¨æ—¶è‡ªåŠ¨æ”¶ç¼©
            document.addEventListener('click', (e) => {
                if (!controlsPanel.contains(e.target) && !controlsPanel.classList.contains('collapsed')) {
                    controlsPanel.classList.add('collapsed');
                    console.log('ç‚¹å‡»å¤–éƒ¨åŒºåŸŸï¼Œæ§åˆ¶é¢æ¿è‡ªåŠ¨æ”¶ç¼©');
                }
            });

            // é˜»æ­¢ç‚¹å‡»æ§åˆ¶é¢æ¿å†…éƒ¨æ—¶å†’æ³¡
            controlsPanel.addEventListener('click', (e) => {
                if (!e.target.classList.contains('controls-toggle-btn') && e.target !== controlsToggle) {
                    e.stopPropagation();
                }
            });

            // å¤§çº²æŒ‰é’®äº‹ä»¶ç›‘å¬å™¨
            const outlineToggle = document.getElementById('outlineToggle');
            const outlinePanel = document.getElementById('outlinePanel');
            const outlineList = document.getElementById('outlineList');
            const thumbnailContainer = document.getElementById('thumbnailContainer');
            const prevArrow = document.getElementById('prevArrow');
            const nextArrow = document.getElementById('nextArrow');

            outlineToggle.addEventListener('click', toggleOutlinePanel);

            // æ§åˆ¶é¢æ¿æ»‘å—äº‹ä»¶ç›‘å¬å™¨
            const radiusSlider = document.getElementById('radiusSlider');
            const depthSlider = document.getElementById('depthSlider');
            const scaleSlider = document.getElementById('scaleSlider');
            radiusSlider.addEventListener('input', (e) => {
                radiusFactor = parseFloat(e.target.value);
                document.getElementById('radiusValue').textContent = radiusFactor.toFixed(1);
                recalculateLayout();
                createNavGlobeDots(); // é‡æ–°åˆ›å»ºå¯¼èˆªçƒç‚¹
            });
            depthSlider.addEventListener('input', (e) => {
                ySpreadFactor = parseFloat(e.target.value);
                document.getElementById('depthValue').textContent = ySpreadFactor.toFixed(2);
                recalculateLayout();
                createNavGlobeDots(); // é‡æ–°åˆ›å»ºå¯¼èˆªçƒç‚¹
            });
            scaleSlider.addEventListener('input', (e) => {
                targetScale = parseFloat(e.target.value);
                document.getElementById('scaleValue').textContent = targetScale.toFixed(1);
            });

            // å¯åŠ¨åŠ¨ç”»å¾ªç¯å’Œå†…å®¹æ›´æ–°
            animationLoop();
            setInterval(() => windows.forEach(updateContent), 5000); // ğŸ”„ å¯ä¿®æ”¹ï¼šå†…å®¹æ›´æ–°é—´éš”(æ¯«ç§’)
            
            // å¯åŠ¨JARVISå³ä¸‹è§’æ•ˆæœ
            initParticleBackground();
            init3DSpheres();
            initCornerTechIcons();
        }

        // =================================================================
        // ğŸ¬ SYSTEM STARTUP - ç³»ç»Ÿå¯åŠ¨
        // =================================================================
        // è¯´æ˜ï¼šå¯åŠ¨æ•´ä¸ªç³»ç»Ÿ
        // âŒ ä¸è¦ä¿®æ”¹ï¼šè¿™æ˜¯ç³»ç»Ÿå…¥å£ç‚¹
        // =================================================================
        init();
    </script>
</body>
</html>